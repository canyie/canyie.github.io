<!DOCTYPE html><html><head hexo-theme="https://volantis.js.org/#2.5.1"><meta charset="utf-8"><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="HandheldFriendly" content="True"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>Android 2025 年每月安全补丁分析索引 - 残页的小博客</title><meta name="keywords" content="android,system,安全,安全补丁分析栏目"><meta name="description" content="2024 年度补丁分析：点我给大家分享一个好消息，经过一年的研究，我现在在 Google BugHunters 平台上总排名 32，2024 年度第 6 名，Android Program 第 6 名！感谢各位一年陪伴！最后更新时间：2025/05/08 更新内容：更新 03 04 05"><link rel="alternate" href="/atom.xml" title="残页的小博客"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css"><link rel="shortcut icon" type="image/x-icon" href="/data/image/favicon.ico"><link rel="stylesheet" href="/css/style.css"><script>function setLoadingBarProgress(e){document.getElementById("loading-bar").style.width=e+"%"}</script></head><body><div id="loading-bar-wrapper"><div id="loading-bar"></div></div><header class="l_header shadow blur"><div class="container"><div class="wrapper"><div class="nav-sub"><p class="title"></p><ul class="switcher nav-list-h"><li><a class="s-comment fas fa-comments fa-fw" target="_self" href="javascript:void(0)"></a></li><li><a class="s-toc fas fa-list fa-fw" target="_self" href="javascript:void(0)"></a></li></ul></div><div class="nav-main"><a class="title flat-box" target="_self" href="/">残页的小博客</a><div class="menu navigation"><ul class="nav-list-h"><li><a class="flat-box" href="/" id="home"><i class="fas fa-rss fa-fw"></i>博客</a></li><li><a class="flat-box" href="/tags/" id="tags"><i class="fas fa-tags fa-fw"></i>标签</a></li><li><a class="flat-box" href="/archives/" id="archives"><i class="fas fa-archive fa-fw"></i>归档</a></li><li><a class="flat-box" href="/friends/" id="friends"><i class="fas fa-link fa-fw"></i>友链</a></li><li><a class="flat-box" href="/about/" id="about"><i class="fas fa-info-circle fa-fw"></i>关于</a></li></ul></div><div class="m_search"><form name="searchform" class="form u-search-form"><i class="icon fas fa-search fa-fw"></i> <input type="text" class="input u-search-input" placeholder="搜索……"></form></div><ul class="switcher nav-list-h"><li><a class="s-search fas fa-search fa-fw" target="_self" href="javascript:void(0)"></a></li><li><a class="s-menu fas fa-bars fa-fw" target="_self" href="javascript:void(0)"></a><ul class="menu-phone list-v navigation white-box"><li><a class="flat-box" href="/" id="home"><i class="fas fa-rss fa-fw"></i>博客</a></li><li><a class="flat-box" href="/tags/" id="tags"><i class="fas fa-tags fa-fw"></i>标签</a></li><li><a class="flat-box" href="/archives/" id="archives"><i class="fas fa-archive fa-fw"></i>归档</a></li><li><a class="flat-box" href="/friends/" id="friends"><i class="fas fa-link fa-fw"></i>友链</a></li><li><a class="flat-box" href="/about/" id="about"><i class="fas fa-info-circle fa-fw"></i>关于</a></li></ul></li></ul></div></div></div></header><script>setLoadingBarProgress(40)</script><div class="l_body nocover"><div class="body-wrapper"><div class="l_main"><article id="post" class="post white-box shadow blur article-type-post" itemscope itemprop="blogPost"><section class="meta"><div class="meta" id="header-meta"><h1 class="title"><a href="/2025/01/29/android-security-bulletin-index-2025/">Android 2025 年每月安全补丁分析索引</a></h1><div class="new-meta-box"><div class="new-meta-item author"><a href="https://blog.canyie.top/" rel="nofollow"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/data/image/avatar_new.jpg"><p>canyie</p></a></div><div class="new-meta-item date"><a class="notlink"><i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i><p>发布于2025年1月29日</p></a></div><div class="new-meta-item wordcount"><a class="notlink"><i class="fas fa-keyboard fa-fw" aria-hidden="true"></i><p>字数：6.1k字</p></a></div><div class="new-meta-item readtime"><a class="notlink"><i class="fas fa-hourglass-half fa-fw" aria-hidden="true"></i><p>时长：24分钟</p></a></div><div class="new-meta-item browse busuanzi"><a class="notlink"><i class="fas fa-eye fa-fw" aria-hidden="true"></i><p><span id="busuanzi_value_page_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></p></a></div></div><hr></div></section><section class="article typo"><div class="article-entry" itemprop="articleBody"><p>2024 年度补丁分析：<a href="https://blog.canyie.top/2024/04/18/android-security-bulletin-index/">点我</a></p><p>给大家分享一个好消息，经过一年的研究，我现在在 Google BugHunters 平台上总排名 32，2024 年度第 6 名，Android Program 第 6 名！感谢各位一年陪伴！</p><p>最后更新时间：2025/05/08 更新内容：更新 03 04 05</p><a id="more"></a><p>状态更新：由于本人健康问题，预计近期对电子产品的使用将会受限，此博客跟我的频道可能会更新缓慢，尝试联系我可能无法连通或回复缓慢，建议关注我的频道获取最新状态</p><h2 id="2025-05-01"><a href="#2025-05-01" class="headerlink" title="2025-05-01"></a>2025-05-01</h2><p>在野利用漏洞：<a href="https://nvd.nist.gov/vuln/detail/CVE-2025-27363" target="_blank" rel="noopener">CVE-2025-27363</a>，终于不是 USB 了</p><h3 id="Framework"><a href="#Framework" class="headerlink" title="Framework"></a>Framework</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-21342" target="_blank" rel="noopener">CVE-2023-21342</a> EoP High<br>绑定到应用提供的 speech RecognitionService 时不指定 BIND_ALLOW_BACKGROUND_ACTIVITY_STARTS 标记，避免 BAL bypass<br>Android 14 就修了的洞，现在 backport 给 13</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34739" target="_blank" rel="noopener">CVE-2024-34739</a> EoP High<br>去年八月就放过一遍，不知道为什么又放了一遍。设置向导未完成时，插入 USB 设备不弹出 activity，避免 FRP 绕过。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0077" target="_blank" rel="noopener">CVE-2025-0077</a> EoP High<br>切换用户过程中的 race condition，有概率导致切换到其他用户后不显示目标用户设置的锁屏。只影响 15。<br>这个问题我很早也注意到了，可惜一直没能稳定复现出来。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0087" target="_blank" rel="noopener">CVE-2025-0087</a> EoP High<br>PackageInstaller 内的逻辑 bug，请求为其他用户卸载 app 时只在当前用户是目标用户的父用户的情况下才允许。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22425" target="_blank" rel="noopener">CVE-2025-22425</a> EoP High<br>PackageInstaller 内使用了不安全的 getCallingPackage 函数获取调用者，可能被伪造结果，改成使用 getLaunchedFromPackage。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-26422" target="_blank" rel="noopener">CVE-2025-26422</a> EoP High<br>WindowManagerService dump 函数内的权限检查放错了位置，调用者传递 <code>--high-priority</code> 参数的时候不会检查权限，造成敏感信息泄露。只影响 15。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-26426" target="_blank" rel="noopener">CVE-2025-26426</a> EoP High<br>registerReceiver 在调用者给定 <code>caller package = &quot;android&quot;</code> 时需要保证 calling uid 真的是 core uid。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-26427" target="_blank" rel="noopener">CVE-2025-26427</a> EoP High<br>跟 CVE-2024-0032 一样，限制不让访问 /sdcard/Android/data。不知道同一个漏洞还能放多少遍。。。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-26428" target="_blank" rel="noopener">CVE-2025-26428</a> EoP High<br>如果当前 task 已经进入 lock task mode，忽略后续的 app pinning 请求。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-26436" target="_blank" rel="noopener">CVE-2025-26436</a> EoP High<br>清楚一个 PendingIntentRecord 的 BAL token 的时候也要顺带清掉它带的 allowlist duration。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-26440" target="_blank" rel="noopener">CVE-2025-26440</a> EoP High<br>CameraService 优化 app 前后台状态改变时的处理代码，避免后台 app 仍然能使用摄像头的问题</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-26444" target="_blank" rel="noopener">CVE-2025-26444</a> EoP High<br>VoiceInteractionManagerService 会在用户强行停止第三方语音助手时将目前选择的语音助手设置成系统默认的，重设 ROLE_ASSISTANT 会导致额外权限被授权给默认的语音助手，这不是合理的行为所以删除相关处理。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-26424" target="_blank" rel="noopener">CVE-2025-26424</a> ID High<br>VpnManagerService 新增的 getFromVpnProfileStore、putIntoVpnProfileStore、removeFromVpnProfileStore、listFromVpnProfileStore 添加权限检查。只影响 15</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-26442" target="_blank" rel="noopener">CVE-2025-26442</a> ID High<br>之前 CVE-2024-49742 的补丁有问题，错误的检查了 resolve 出来的组件的包名而非整个组件名，所以可以通过声明两个组件的方式来绕过补丁。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-26429" target="_blank" rel="noopener">CVE-2025-26429</a> DoS High<br>AppOpsService collectOps 内限制返回的数据大小，避免过大超过 binder 数据传输大小限制造成异常。</p><h3 id="System"><a href="#System" class="headerlink" title="System"></a>System</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-27363" target="_blank" rel="noopener">CVE-2025-27363</a> RCE High<br>上游 freetype 中的整数溢出 bug</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-26420" target="_blank" rel="noopener">CVE-2025-26420</a> EoP High<br>官方未放出此漏洞补丁链接，手动查找得到：<a href="https://android.googlesource.com/platform/packages/modules/Permission/+/5c07da90f7ae911b9e64d4e34871b7d2115a0a7f" target="_blank" rel="noopener">https://android.googlesource.com/platform/packages/modules/Permission/+/5c07da90f7ae911b9e64d4e34871b7d2115a0a7f</a><br>看起来是显示多个权限请求对话框时的内容遮盖问题。官方给出的漏洞描述：</p><blockquote><p>In multiple functions of GrantPermissionsActivity.java , there is a possible way to trick the user into granting the incorrect permission due to permission overload. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is not needed for exploitation.</p></blockquote><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-26421" target="_blank" rel="noopener">CVE-2025-26421</a> EoP High<br>添加了一个可以自定义的 config_biometric_protected_package_names，当用户在设置里尝试强行停止、禁用或卸载这些被保护的 app 的更新时要求用户验证身份再继续。没太看懂，漏洞描述：</p><blockquote><p>In multiple locations, there is a possible lock screen bypass due to a logic error in the code. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is not needed for exploitation.</p></blockquote><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-26423" target="_blank" rel="noopener">CVE-2025-26423</a> EoP High<br>添加 Wi-Fi 网络时检查附带的 IpConfiguration 和 ProxyInfo 的大小。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-26425" target="_blank" rel="noopener">CVE-2025-26425</a> EoP High<br>RoleService 的 getDefaultApplicationAsUser/setDefaultApplicationAsUser 两个 API 限制只能在 Android 14+ 上被调用，因为里面是通过检查 MANAGE_DEFAULT_APPLICATIONS 这个权限来确保这些 API 不被滥用的，在 Android 13 或更低版本的系统上 MANAGE_DEFAULT_APPLICATIONS 权限并不存在，所以第三方 app 可以自己定义这个权限然后给自己授权从而绕过 RoleService 里面的检查。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-26430" target="_blank" rel="noopener">CVE-2025-26430</a> EoP High<br>Settings SpaAppBridgeActivity 里检查 package name 只能包含合法字符串，猜测是注入 / 字符伪造后面的 user id</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-26435" target="_blank" rel="noopener">CVE-2025-26435</a> EoP High<br>禁止访客用户禁用 deceptive app scanning</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-26438" target="_blank" rel="noopener">CVE-2025-26438</a> EoP High<br>蓝牙 SMP 协议实现中的验证绕过 bug</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-35657" target="_blank" rel="noopener">CVE-2023-35657</a> ID High<br>蓝牙 BTA 层的类型混淆，会导致越界读</p><h2 id="2025-04-01"><a href="#2025-04-01" class="headerlink" title="2025-04-01"></a>2025-04-01</h2><p>Android 12 &amp; 12L 的支持已于本月结束，呜呜呜<br>在野利用漏洞：<a href="https://nvd.nist.gov/vuln/detail/CVE-2024-53150" target="_blank" rel="noopener">CVE-2024-53150</a>、<a href="https://nvd.nist.gov/vuln/detail/CVE-2024-53197" target="_blank" rel="noopener">CVE-2024-53197</a>，都是内核 USB 模块</p><h3 id="Framework-1"><a href="#Framework-1" class="headerlink" title="Framework"></a>Framework</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22429" target="_blank" rel="noopener">CVE-2025-22429</a> ID Critical<br>bundle 解析过程中的逻辑 bug，try 块中调用 readArrayMap 解析其值，finally 块中判断若 lazy value 数量为 0 则说明不需要 lazy unparcel，直接释放 parcel。但这个 lazy value 数量是使用 readArrayMap 的返回值来描述的，如果 readArrayMap 已经成功创建了一些 LazyValue 但在后续解析过程中抛出异常，由于 readArrayMap 并没有正常返回自然也就没有返回值，此时上层记录的 lazy value 数量还是 0，parcel 在 finally 中被释放，后续 LazyValue 再使用 parcel 就会产生 UAF。注意，若进程开启了 Defuse （在 system_server 内满足此条件），对 BadParcelableException 的 catch 块内清空了 map，而从代码上来看失去引用的 LazyValue 并不会操作 parcel，所以我猜测想实际触发这个漏洞需要一个并非 BadParcelableException 但在上层被 catch 的异常才能让 LazyValue 驻留在 map 里？<br>类似之前的 leak value，但在没有另一个能倒退 parcel position 的漏洞的情况下是否能像之前那样利用？从漏洞描述上来看应该是做到了代码执行的</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22416" target="_blank" rel="noopener">CVE-2025-22416</a> EoP High<br>ChooserActivity 预览 ChooserTarget 的 icon 时先检查是否有权限读取 uri。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22417" target="_blank" rel="noopener">CVE-2025-22417</a> EoP High<br>WindowManager transaction 过程中的 race condition，看的不是很明白。漏洞描述：</p><blockquote><p>In finishTransition of Transition.java, there is a possible way to bypass touch filtering restrictions due to a tapjacking/overlay attack. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is needed for exploitation.</p></blockquote><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22422" target="_blank" rel="noopener">CVE-2025-22422</a> EoP High<br>System UI 处理 authentication prompt 时的逻辑 bug，当 top app 和 client app 不一样时说明可能真正请求验证的 app 已经被恶意 app 顶到了后台，用户看见的可能是恶意 app 显示的内容（类似 task hijacking），这个时候需要告知原来的 client 验证失败。但是在使用了 createConfirmDeviceCredentialIntent （会 resolve 到 settings 的 ConfirmDeviceCredentialActivity）而非手动调用 BiometricPrompt 进行验证的情况，此时直接发起验证流程的 client package 是 settings，即使后续 top activity 变成了 settings 的其他 activitiy，这个判断也会认为 top app 并没有改变从而不会取消验证请求。利用这个 bug 应该需要能找到足够具有迷惑性的 activity 所以应该还挺麻烦的？补丁加了一个 top activity 的 class name 检查。<br>相关引用：<a href="https://android.googlesource.com/platform/frameworks/base/+/9588cd7de1f84a3ec8de273fb7d75921024189d8%5E%21/#F0" target="_blank" rel="noopener">CVE-2020-27059</a></p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22424" target="_blank" rel="noopener">CVE-2025-22424</a> EoP High<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22426" target="_blank" rel="noopener">CVE-2025-22426</a> EoP High<br>pm ComputerEngine resolveContentProvider 同时接收 uri 的 authority 和 user id，但调用者可能会把 user id 存储在 authority 内，要把这个 user id 提取出来。不太清楚具体是哪里可能会发生这种情况，感觉挺有意思的</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22434" target="_blank" rel="noopener">CVE-2025-22434</a> EoP High<br>用户点击键盘上打开系统设置的快捷键时没有检查是否有锁屏就直接打开了设置 app，造成锁屏绕过。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22437" target="_blank" rel="noopener">CVE-2025-22437</a> EoP High<br>注意官方公告放错了补丁！！官方公告里放的补丁和 CVE-2024-49728 一致，但是正确的补丁其实是 <a href="https://android.googlesource.com/platform/frameworks/base/+/25d6165d462ad8fe83ea8dd254214a420bc1a526" target="_blank" rel="noopener">https://android.googlesource.com/platform/frameworks/base/+/25d6165d462ad8fe83ea8dd254214a420bc1a526</a><br>其实这个漏洞和 2023 年 11 月公告 CVE-2023-40111 是一样的，当时可能由于兼容性考虑只给 android 14 上了这个 patch，现在可能是觉得不妥当又给 backport 到了 13。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22438" target="_blank" rel="noopener">CVE-2025-22438</a> EoP High<br>input dispatcher 里的加锁问题，会导致 dispatchEntry 这个变量 UAF</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22442" target="_blank" rel="noopener">CVE-2025-22442</a> EoP High<br>work profile 默认禁用开发者选项，看漏洞描述是能往 profile 里装 app</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49722" target="_blank" rel="noopener">CVE-2024-49722</a> ID High<br>在系统设置里更换用户头像的时候使用显式 intent 进行图片选择，确保只启动系统自己的头像选择器。<br>（这个问题反反复复修复几遍怎么又来了？之前测试过这里没能测出什么问题，这次只给 15 更新了，可能是新版本又加了什么东西）</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22421" target="_blank" rel="noopener">CVE-2025-22421</a> ID High<br>通知的 content description （用于无障碍）里不要包含通知内容，否则可能会被读屏软件在没解锁屏幕的时候就读出来</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22430" target="_blank" rel="noopener">CVE-2025-22430</a> ID High<br>TrustManager 新增的 isInSignificantPlace 方法需要 ACCESS_FINE_LOCATION 权限。只影响 15</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22431" target="_blank" rel="noopener">CVE-2025-22431</a> DoS High<br>AppOpsService 内即使直接调用者可信也不应该直接信任由 proxy app 提供的 proxied attribution tag，改为只在没有 proxy app 或其是系统 app 时才信任</p><h3 id="System-1"><a href="#System-1" class="headerlink" title="System"></a>System</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-26416" target="_blank" rel="noopener">CVE-2025-26416</a> EoP Critical<br>skia 解码 bmp 图片时的未初始化变量</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22423" target="_blank" rel="noopener">CVE-2025-22423</a> DoS Critical<br>dng_sdk 里如果 tag count 非法则提前返回，避免后续崩溃</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-40653" target="_blank" rel="noopener">CVE-2024-40653</a> EoP High<br>Telecomm 里如果绑定到 ConnectionService 后 15 秒还没有响应就解绑</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49720" target="_blank" rel="noopener">CVE-2024-49720</a> EoP High<br>通过 role 授予权限时把用户之前对该权限选择的“每次都询问”视为有效的用户决定，不要去覆盖它</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49730" target="_blank" rel="noopener">CVE-2024-49730</a> EoP High<br>fuse daemon 内增大 MAX_READ_SIZE，看描述是 oob write</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22418" target="_blank" rel="noopener">CVE-2025-22418</a> EoP High<br>系统设置内选择铃声的 intent 指定包名，怀疑跟之前那堆铃声漏洞（CVE-2023-40108、CVE-2023-40132）是一样的</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22419" target="_blank" rel="noopener">CVE-2025-22419</a> EoP High<br>telephony app 多个 activity 添加 flag 防止被悬浮窗覆盖。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22427" target="_blank" rel="noopener">CVE-2025-22427</a> EoP High<br>settings NotificationAccessConfirmationActivity 错误地将 SYSTEM_FLAG_HIDE_NON_SYSTEM_OVERLAY_WINDOWS 传递给 addFlags （作为一个 system flag 应该使用 addSystemFlags/addPrivateFlags），导致其被错误解释为了 FLAG_SHOW_WHEN_LOCKED 从而显示在了锁屏之上，不解锁就可以授权。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22428" target="_blank" rel="noopener">CVE-2025-22428</a> EoP High<br>在我之前那个 CVE-2024-43088 的补丁基础之上把检查 calling package 的权限更换为了检查 calling uid 的权限。不是很懂，猜测是可能有一个 app 在主用户上有跨用户权限但在次用户上没权限的情况？</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22432" target="_blank" rel="noopener">CVE-2025-22432</a> EoP High<br>此漏洞由我发现并报告。<br>telecomm 内使用了 BIND_ALLOW_BACKGROUND_ACTIVITY_STARTS 来 bind CallRedirectionSevice（其是 BAL 豁免名单之一），所以响应超时了也需要 unbind，否则会导致 BAL bypass。更多内容可见于 <a href="https://wrlus.com/android-security/bindservice-error-handle/" target="_blank" rel="noopener">https://wrlus.com/android-security/bindservice-error-handle/</a></p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22433" target="_blank" rel="noopener">CVE-2025-22433</a> EoP High<br>IntentForwarderActivity 内检查 intent 是否可以被转发到其他 profile 时的逻辑 bug，如果 intent 有 selector 那这个 intent 本身和 selector 都要被检查。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22435" target="_blank" rel="noopener">CVE-2025-22435</a> EoP High<br>蓝牙 AVDT 协议实现里增加了一个消息类型检查，防止可能的类型混淆</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22439" target="_blank" rel="noopener">CVE-2025-22439</a> EoP High<br>DocumentUI 加载 last accessed stack 记录的 uri 时忘记校验 uri，可以绕过存储限制授权</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49728" target="_blank" rel="noopener">CVE-2024-49728</a> ID High<br>通过蓝牙发送文件时检查传递的 uri 是否为指向其他用户的 uri。印象中很久以前我是测试过这里的，没利用成功，不知道咋复现的</p><h2 id="2025-03-01"><a href="#2025-03-01" class="headerlink" title="2025-03-01"></a>2025-03-01</h2><p>在野利用漏洞：<a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43093" target="_blank" rel="noopener">CVE-2024-43093</a>、 <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-50302" target="_blank" rel="noopener">CVE-2024-50302</a><br>懒得放补丁链接了，自己去官方公告里面找吧</p><h3 id="Framework-2"><a href="#Framework-2" class="headerlink" title="Framework"></a>Framework</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-0032" target="_blank" rel="noopener">CVE-2024-0032</a> EoP High<br>去年2月补丁里放过的，限制通过 SAF 访问 /sdcard/Android/data。不知道为啥重新放了一遍。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43093" target="_blank" rel="noopener">CVE-2024-43093</a> EoP High<br>跟去年11月补丁的一样，自己去看去年的分析吧，懒得再写一遍了。去年忘了给 12L 更新，重新放一遍。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0078" target="_blank" rel="noopener">CVE-2025-0078</a> EoP High<br>service manager 注册自己的时候需要打开 requesting sid 从而可以正确检索 caller 的 selinux context。关于 requesting sid 的更多信息见 <a href="https://project-zero.issues.chromium.org/issues/42450815" target="_blank" rel="noopener">https://project-zero.issues.chromium.org/issues/42450815</a> （CVE-2019-2023 及相关的一系列漏洞）</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0080" target="_blank" rel="noopener">CVE-2025-0080</a> EoP High<br>PackageInstaller unarchive app 的对话框添加 flag 防止被 overlay。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43090" target="_blank" rel="noopener">CVE-2024-43090</a> ID High<br>此漏洞由我发现并报告。<br>去年11月放过的，systemui 里面的 icon 跨用户泄露，当时在 Android 15 上忘了启用相关 flag 导致补丁没生效，所以重新放一遍</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0083" target="_blank" rel="noopener">CVE-2025-0083</a> ID High<br>telecom 内使用 getAuthority() 然后手动解析 @ 字符前面的内容去获取 uri 内的 user id 而非使用 getEncodedUserInfo。从 commit message 内大概可以猜测是把 @ 字符使用 uri encode 的格式来绕过原来的补丁。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0086" target="_blank" rel="noopener">CVE-2025-0086</a> ID High<br>AccountManagerService getAuthToken 校验 Authenticator 返回的 account type，避免读到其他 account 数据。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49740" target="_blank" rel="noopener">CVE-2024-49740</a> DoS High<br>telephony 限制 VisualVoicemailSmsFilterSettings 必须由默认拨号 app 设置，同时限制其内容的大小</p><h3 id="System-2"><a href="#System-2" class="headerlink" title="System"></a>System</h3><p>下面有很多一个补丁链接对应多个漏洞的情况，不一一复制粘贴了，看得明白就行</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0074" target="_blank" rel="noopener">CVE-2025-0074</a> RCE Critical<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22403" target="_blank" rel="noopener">CVE-2025-22403</a> RCE Critical<br>bluetooth sdp sdp_discovery.cc 内两处出错 log 里使用了可能已经被释放掉的指针，造成 UAF。真的能造成 RCE？我持怀疑态度。只影响 15。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0075" target="_blank" rel="noopener">CVE-2025-0075</a> RCE Critical<br>sdp_server.cc log 语句内的 UAF，跟上面一样。只影响 15。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0084" target="_blank" rel="noopener">CVE-2025-0084</a> RCE Critical<br>蓝牙 SDP 协议实现中，同一个客户端发起多个连接可能导致 UAF</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22408" target="_blank" rel="noopener">CVE-2025-22408</a> RCE Critical<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22410" target="_blank" rel="noopener">CVE-2025-22410</a> RCE Critical<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22411" target="_blank" rel="noopener">CVE-2025-22411</a> RCE Critical<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22412" target="_blank" rel="noopener">CVE-2025-22412</a> RCE Critical<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22409" target="_blank" rel="noopener">CVE-2025-22409</a> EoP Critical<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22404" target="_blank" rel="noopener">CVE-2025-22404</a> EoP High<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22405" target="_blank" rel="noopener">CVE-2025-22405</a> EoP High<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22406" target="_blank" rel="noopener">CVE-2025-22406</a> EoP High<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22407" target="_blank" rel="noopener">CVE-2025-22407</a> ID High<br>跟上面一堆是类似问题，蓝牙 log 内可能使用已经被释放的变量导致 UAF。真的有必要搞这么多 CVE？只影响 15。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0081" target="_blank" rel="noopener">CVE-2025-0081</a> DoS Critical<br>解析 jpeg 时如果哈夫曼表为空直接 abort</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-21125" target="_blank" rel="noopener">CVE-2023-21125</a> EoP High<br>蓝牙 btif/src/btif_hh.cc 内的 UAF 问题</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0079" target="_blank" rel="noopener">CVE-2025-0079</a> EoP High<br>蓝牙 AVCTP/AVDTP 指定 BTA_SEC_ENCRYPT 保证加密传输</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0082" target="_blank" rel="noopener">CVE-2025-0082</a> ID High<br>补丁跟上面的 CVE-2025-0083 是一样的。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0092" target="_blank" rel="noopener">CVE-2025-0092</a> ID High<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0093" target="_blank" rel="noopener">CVE-2025-0093</a> ID High<br>蓝牙设备解除绑定时重置短信、通讯录、SIM 权限授权状态</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-26417" target="_blank" rel="noopener">CVE-2025-26417</a> ID High<br>将已经下载好的文件插入进 DownloadProvider （DownloadManager.addCompletedDownload）时，确保路径对应文件的所有者与调用者匹配，否则恶意应用可以通过插入操作产生的 DownloadProvider 的 id 通过 DownloadProvider 的权限访问该文件</p><h2 id="2025-02-01"><a href="#2025-02-01" class="headerlink" title="2025-02-01"></a>2025-02-01</h2><p>可能的被在野利用漏洞：<a href="https://nvd.nist.gov/vuln/detail/CVE-2024-53104" target="_blank" rel="noopener">CVE-2024-53104</a>，内核中 USB 模块的越界写入</p><h3 id="Framework-3"><a href="#Framework-3" class="headerlink" title="Framework"></a>Framework</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49721" target="_blank" rel="noopener">CVE-2024-49721</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/7714ccb85ed961083dcc97e230c71242c3422b5e" target="_blank" rel="noopener">1</a><br>见 <a href="https://blog.canyie.top/2025/02/04/CVE-2024-49721/">CVE-2024-49721 InputMethodSubtypeArray 反序列化漏洞分析</a></p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49743" target="_blank" rel="noopener">CVE-2024-49743</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/72a3d2d72c39fd48f0a960a1b3c1e16e307421df" target="_blank" rel="noopener">1</a> <a href="https://android.googlesource.com/platform/frameworks/base/+/b8a1a5d47c3916fe08deefaefd8772092b4fb03c" target="_blank" rel="noopener">2</a> <a href="https://android.googlesource.com/platform/frameworks/base/+/f1fd60bb80f9ea95c61b5392102a4afedd948188" target="_blank" rel="noopener">3</a><br>这个漏洞比较复杂，后续会单独发文章解析，敬请期待</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49746" target="_blank" rel="noopener">CVE-2024-49746</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/native/+/9aaf913c6f0efc93e805a6baa02d2077108809e1" target="_blank" rel="noopener">1</a> <a href="https://android.googlesource.com/platform/frameworks/native/+/b3cdb06ab9137a67e4ee212ae6655de383fdaaaa" target="_blank" rel="noopener">2</a><br>Parcel::continueWrite 中的 fd 处理问题，看起来是会错误 close 掉不该被关闭的 fd？还加了很多溢出的检查</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0097" target="_blank" rel="noopener">CVE-2025-0097</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/a4a8fca641b0671a8c1d2bb3857dc5fc40d01704" target="_blank" rel="noopener">1</a><br>WindowManagerService transferTouchGesture 中除了校验 token 还需要校验 calling uid 跟 owner uid 相等。只影响 15</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0098" target="_blank" rel="noopener">CVE-2025-0098</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/9515a9448c528d45c9b673e2e9b61971bc7e58c1" target="_blank" rel="noopener">1</a><br>TaskFragmentOrganizerController 内会检查 activity 的 pid 与注册 organizer 的时候的 calling pid 是否相等，如果不相等说明不是同一个进程，这个时候不发送 activity token 以避免它泄露。但是这个检查存在缺陷，因为如果 app 进行 binder transact 的时候指定了 FLAG_ONEWAY，说明这是一个异步调用，这个时候被调用者拿到的 calling pid 会是 0，以此可以泄露出 pid 是 0 的 ActivityRecord 的 token。什么时候 ActivityRecord 的 pid 是 0？怀疑是 activity 所属的进程已经退出了的时候。只影响 15。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0099" target="_blank" rel="noopener">CVE-2025-0099</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/7946586c33503bc383403faec48ffcea39e365ac" target="_blank" rel="noopener">1</a><br>CompanionDeviceManagerService 新增的 getBackupPayload 和 applyRestoredPayload 这两个函数没有权限检查，应该加上 uid 校验，只允许 system 身份调用。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-40133" target="_blank" rel="noopener">CVE-2023-40133</a> ID High<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-0037" target="_blank" rel="noopener">CVE-2024-0037</a> ID High<br><a href="https://android.googlesource.com/platform/frameworks/base/+/2d1d69e1571c7814661b81a468af127c940a1cd8" target="_blank" rel="noopener">1</a><br>检查 Autofill 相关的 Slice 中的 Icon URI 是否属于当前用户，避免跨用户泄漏。这个应该是去年就放过一次，不知道为什么又放了一遍</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-40134" target="_blank" rel="noopener">CVE-2023-40134</a> ID High<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-40135" target="_blank" rel="noopener">CVE-2023-40135</a> ID High<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-40136" target="_blank" rel="noopener">CVE-2023-40136</a> ID High<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-40137" target="_blank" rel="noopener">CVE-2023-40137</a> ID High<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-40138" target="_blank" rel="noopener">CVE-2023-40138</a> ID High<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-40139" target="_blank" rel="noopener">CVE-2023-40139</a> ID High<br><a href="https://android.googlesource.com/platform/frameworks/base/+/08becc8c600f14c5529115cc1a1e0c97cd503f33" target="_blank" rel="noopener">1</a><br>检查 Autofill 相关 RemoteViews 中 URI 是否全部属于当前用户，避免跨用户泄漏。这个去年也放过一次，同样搞不懂为什么又放</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0100" target="_blank" rel="noopener">CVE-2025-0100</a> ID High <a href="https://android.googlesource.com/platform/frameworks/base/+/0e462ffab7727e282af15945aeecdb9b1709e4e9" target="_blank" rel="noopener">1</a><br>此漏洞由我发现并报告。<br>SystemUI MediaProjectionPermissionActivity 使用 getCallingPackage 获取调用者然后校验其权限，如果是特权应用就跳过确认环节。但是 getCallingPackage 的返回结果实际上可以被伪造，补丁改成了更准确的 getLaunchedFromPackage。<br>这里有一个好玩的点，就是 getCallingPackage 返回的是哪个 app 会收到当前 Activity 返回的结果，所以可以被伪造，但是 SystemUI 需要把 IMediaProjection 返回给调用者然后调用者才能使用它开始录屏，伪造 getCallingPackage 实际上会导致应用收不到返回的 binder 自然也就无法完成后续利用。那么这个看起来触发条件和可用性相悖的漏洞是怎么被利用的呢？这里先卖个关子，读者可以先自己思考思考。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49741" target="_blank" rel="noopener">CVE-2024-49741</a> DoS High <a href="https://android.googlesource.com/platform/frameworks/base/+/047bc1ce62f84aa0bd5827b49edb330e1cc2da8b" target="_blank" rel="noopener">1</a><br>此漏洞由我发现并报告。AppWidgetServiceImpl 中限制一个应用最多可以创建 20 个 host，每个 host 可以拥有 200 个 widget，这个补丁之前是完全没有限制的，所以可能发生超大数据量导致 DoS。</p><h3 id="Platform"><a href="#Platform" class="headerlink" title="Platform"></a>Platform</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0094" target="_blank" rel="noopener">CVE-2025-0094</a> EoP High <a href="https://android.googlesource.com/platform/packages/apps/Settings/+/c86bccb4e1d3af30e7e89310a3f176091eb497ef" target="_blank" rel="noopener">1</a><br>禁止 work profile 打开多用户管理页面，看漏洞描述是可以移除 work profile？</p><h3 id="System-3"><a href="#System-3" class="headerlink" title="System"></a>System</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0091" target="_blank" rel="noopener">CVE-2025-0091</a> EoP High <a href="https://android.googlesource.com/platform/packages/apps/Settings/+/e3bbc415adb51975aeade545725b6931099d412e" target="_blank" rel="noopener">1</a><br>在 Settings 应用中的账号管理页面里，禁止启动带有 content URI 的 intent。跟 <a href="https://blog.canyie.top/2024/11/07/self-changing-data-type/">Self-changing Data Type - CVE-2024-40676 漏洞分析</a> 是同一类漏洞，去年那篇文章一直没发就是为了等这个漏洞审核，可惜 duplicate 了 😭</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0095" target="_blank" rel="noopener">CVE-2025-0095</a> EoP High <a href="https://android.googlesource.com/platform/packages/apps/Settings/+/4b99ae729036d9d8bb75fa9503c10e7c87b27c2c" target="_blank" rel="noopener">1</a><br>Settings AppTimeSpentPreference 中使用一个只有 Action 的隐式 Intent 启动 Activity，可能会被恶意应用劫持。补丁给这个 intent 加上了 setPackage。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0096" target="_blank" rel="noopener">CVE-2025-0096</a> EoP High <a href="https://android.googlesource.com/platform/hardware/st/nfc/+/58728fc8363b3b073f1561b253da4a42998fed11" target="_blank" rel="noopener">1</a><br>nfc 模块里面有个 malloc 的 size 写小了，只影响 15</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49723" target="_blank" rel="noopener">CVE-2024-49723</a> ID High <a href="https://android.googlesource.com/platform/external/conscrypt/+/79117043c54eb2fc91ece695c90938d60904d59f" target="_blank" rel="noopener">1</a> <a href="https://android.googlesource.com/platform/libcore/+/c9d01a45928e0cdd2e6102c1c0ecf23a9de3601f" target="_blank" rel="noopener">2</a><br>移除 Conscrypt 的 3DES 支持，只给 15 更新了</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49729" target="_blank" rel="noopener">CVE-2024-49729</a> ID High <a href="https://android.googlesource.com/platform/system/core/+/a1b00e3f3412c6de6fddb53e603264deb248dace" target="_blank" rel="noopener">1</a><br>fs_mgr/libdm/dm.cpp 中 redact 掉可能的敏感信息，否则会导致其在 bug report 过程中被 dump 出来，泄漏原始加密密钥。</p><h2 id="2025-01-01"><a href="#2025-01-01" class="headerlink" title="2025-01-01"></a>2025-01-01</h2><p>这个月补丁好多，算是解答了上个月的“为什么这么少”的疑问<br>大家新年快乐！一直在等补丁链接，等了一个月还没放，只能先发一个不完整版的了<br>注：本月补丁链接未放出 以下部分补丁来源为手动还原<br>2025/02/24 更新：官方公告里已经放出补丁链接 建议去看官方公告里的；官方公告里移除了 CVE-2023-40108 CVE-2023-40132，不知道为什么</p><h3 id="Framework-4"><a href="#Framework-4" class="headerlink" title="Framework"></a>Framework</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49724" target="_blank" rel="noopener">CVE-2024-49724</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/0af0a98f5e097e0449b2bc1d797e70429cb3b027" target="_blank" rel="noopener">1</a><br>AccountManagerService checkKeyIntent 加了个 setComponent 让 intent 变成显式 intent，防止 resolve 到 startActivity 期间某些影响 intent resolve 流程的因素发生改变，导致 TOCTTOU race condition。具体实例：<a href="https://blog.canyie.top/2024/11/07/self-changing-data-type/">Self-changing Data Type</a>。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49732" target="_blank" rel="noopener">CVE-2024-49732</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/076a97aa32492cc44e863f7ab75494dc0b3bf5ef%5E%21/#F0" target="_blank" rel="noopener">1</a><br>CompanionDeviceManagerService 里新增的 enablePermissionsSync disablePermissionsSync getPermissionSyncRequest 三个 API 缺少权限检查，补丁限制只有 system uid 可以调用。只影响 15。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49735" target="_blank" rel="noopener">CVE-2024-49735</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/a44beb0ca3f788c468748e637a2a947b4b44503e%5E!/#F0" target="_blank" rel="noopener">1</a><br>存储 NotificationChannel 的时候，限制附带的 VibrationEffect 的大小。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49737" target="_blank" rel="noopener">CVE-2024-49737</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/aa31697ed1de3b525a668d8954eabf3e75401e5d" target="_blank" rel="noopener">1</a><br>调用 startActivityInTaskFragment 的时候已经 clearCallingUid 了，之后在 AMS 里构造 SafeActivityOptions 的时候会拿到自己的 uid，改成调用的时候就主动按照已经记录的 calling uid/pid 构造 SafeActivityOptions 再传过去。只影响 13+。看了眼致谢信息，果然是 Michał Bednarski。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49738" target="_blank" rel="noopener">CVE-2024-49738</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/native/+/49eb0ea0816e1fc45101f8b2847d731fc192576f%5E%21/#F0" target="_blank" rel="noopener">1</a><br>Parcel::writeInplace() 在写入数据之前先校验数据。没太看懂咋触发，看描述是越界写。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49744" target="_blank" rel="noopener">CVE-2024-49744</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/0af0a98f5e097e0449b2bc1d797e70429cb3b027" target="_blank" rel="noopener">1</a><br>此漏洞由我发现并报告。<br>AccountManagerService checkKeyIntentParceledCorrectly 里只检查了 intent 的类型，没有检查再次反序列化后 intent 的类型，可以通过 bundle mismatch 的方式绕过。关于绕过了有什么用，可以查看这一篇： <a href="https://konata.github.io/posts/creator-mismatch/" target="_blank" rel="noopener">https://konata.github.io/posts/creator-mismatch/</a><br>注：这个漏洞看起来很明显，但实际上并不好利用，ChooseTypeAndAccountActivity 或者 AddAccountSettings 等常见利用点都已经在之前的 CVE-2023-20944 跟 CVE-2023-21124 的补丁里加上了 new Intent 使得我们伪造的 intent 并不会直接传递给 startActivity。那么如何触发这个漏洞呢？这里先留一个悬念，读者可以自己先思考思考。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49745" target="_blank" rel="noopener">CVE-2024-49745</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/native/+/df99a3903097c70f58ffca2a6e8d815ffeeee2c3%5E%21/#F0" target="_blank" rel="noopener">1</a><br>Parcel::growData 中如果现在的 data position 已经大于 data size 就直接返回。看漏洞描述是越界写。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-40108" target="_blank" rel="noopener">CVE-2023-40108</a> ID High <a href="https://github.com/aosp-mirror/platform_frameworks_base/commit/1b234678ec122994ccbfc52ac48aafdad7fdb1ed" target="_blank" rel="noopener">1</a><br>SettingsProvider 中设置铃声的时候校验这个 URI 确实是一个音频文件。追代码可以看见后面会读取这个 URI 把它写进一个 cache dir 里，这里是以 SettingsProvider 的权限去读取，SettingsProvider 跑在 system_server 里所以是 system 权限，然后这个 cache file 可以通过调用 SettingsProvider 的 openFile() 打开，返回一个 InputStream 而不需要任何权限，所以这里是一个以系统权限读取任意 URI。<br>很早就知道的老问题了，属于有生之年系列，最早应该是 CVE-2022-20353 在 Settings 调用铃声选择器的时候加了校验，看代码可以发现 com.android.dialer.app.settings.DefaultRingtonePreference 也有类似问题（这个月的 CVE-2023-40132），而且铃声属于 Settings.System 组，可以被拿到读写系统设置权限的 app 手动触发。这次在根源上修复了，应该不会再有问题了。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49733" target="_blank" rel="noopener">CVE-2024-49733</a> ID High <a href="https://android.googlesource.com/platform/frameworks/base/+/f46c1bf872075e55f70aa88303f24ee877fe850f" target="_blank" rel="noopener">1</a><br>此漏洞由我发现并报告。<br>Settings 的 ServiceListing 始终显示被启用了的服务，保证用户也能看见有些校验不通过但是已经被启用的服务。<br>感觉类型给错了，应该给 EoP 的</p><h3 id="Media-Framework"><a href="#Media-Framework" class="headerlink" title="Media Framework"></a>Media Framework</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-40132" target="_blank" rel="noopener">CVE-2023-40132</a> EoP High <a href="https://github.com/aosp-mirror/platform_frameworks_base/commit/b8c2d03b720f0cc200ac59f6cfb411fddc3b119c" target="_blank" rel="noopener">1</a> <a href="https://github.com/aosp-mirror/platform_frameworks_base/commit/a3d258ea3b916cf97bfc00a7637cd8efea48d138" target="_blank" rel="noopener">2</a><br>跟上面的 CVE-2023-40108 是一个问题，不再重复解释了。这个补丁比上面那个补丁更早，是在运行在客户端的 RingtoneManager 里也加上文件类型检查，应该是给 com.android.dialer 或者其他 app 的情况用的。上面那个补丁应该也能覆盖这个漏洞的情况。</p><h3 id="System-4"><a href="#System-4" class="headerlink" title="System"></a>System</h3><p>蓝牙开会了属于是<br>待分析漏洞：CVE-2024-49742 CVE-2024-49734</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43096" target="_blank" rel="noopener">CVE-2024-43096</a> RCE Critical <a href="https://review.lineageos.org/c/LineageOS/android_system_bt/+/411006" target="_blank" rel="noopener">1</a><br>蓝牙 GATT 协议栈 build_read_multi_rsp 函数中 MTU 等于 0 时的越界写入，补丁判断了这种情况直接返回。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43770" target="_blank" rel="noopener">CVE-2024-43770</a> RCE Critical<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43771" target="_blank" rel="noopener">CVE-2024-43771</a> RCE Critical<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49747" target="_blank" rel="noopener">CVE-2024-49747</a> RCE Critical<br><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49748" target="_blank" rel="noopener">CVE-2024-49748</a> RCE Critical<br><a href="https://android.googlesource.com/platform/packages/modules/Bluetooth/+/69cb902b23f9aaee04de587045fba66a5cb28e57%5E%21/#F0" target="_blank" rel="noopener">1</a><br>四个漏洞都在 GATT 里，在四个不同的地方都没有检查 gatt_tcb_get_payload_size 的返回值是不是 0，而这个函数在 channel 已经被关闭的时候会返回 0，在后续造成越界写。<br>影响函数：<br>CVE-2024-43770 gatts_process_find_info<br>CVE-2024-43771 gatts_process_read_req<br>CVE-2024-49747 gatts_process_read_by_type_req<br>CVE-2024-49748 gatts_process_primary_service_req</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49749" target="_blank" rel="noopener">CVE-2024-49749</a> RCE High <a href="https://review.lineageos.org/c/LineageOS/android_external_giflib/+/414856" target="_blank" rel="noopener">1</a><br>giflib 解析 gif 的过程中，判断 width 和 height 是否非法的 if 语句存在逻辑错误，变成了只有三项条件全部成立才认为文件非法，应该是三项条件里只要有一项成立就为非法。导致后续计算 size 的时候发生整数溢出进而越界写。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34722" target="_blank" rel="noopener">CVE-2024-34722</a> EoP High <a href="https://android.googlesource.com/platform/packages/modules/Bluetooth/+/2f0cf867e27af9048821d332ecbd21ddf234888c%5E%21/#F0" target="_blank" rel="noopener">1</a><br>蓝牙配对过程中的授权绕过问题，去年补丁就放过一次，看起来是没修复完</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34730" target="_blank" rel="noopener">CVE-2024-34730</a> EoP High <a href="https://android.googlesource.com/platform/system/bt/+/6c3bb34eb3114e9a3dd9868fcab6631b947b9994" target="_blank" rel="noopener">1</a><br>蓝牙 HID 链接过程中的权限绕过问题</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43095" target="_blank" rel="noopener">CVE-2024-43095</a> EoP High <a href="https://android.googlesource.com/platform/packages/modules/Permission/+/f677d33568d944dfe43a713dc148bd68a5472931%5E%21/#F0" target="_blank" rel="noopener">1</a><br>改的地方很多，看起来是动态添加的权限相关的自动授权问题</p><blockquote><p>In multiple locations, there is a possible way to obtain any system permission due to a logic error in the code. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is needed for exploitation.</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Fix Dynamic Permission group auto grant behaivor</span><br><span class="line">Fix the Dynamic Permission group auto grant behaivor so that a</span><br><span class="line">permission group is only considered granted when (1) all permissions</span><br><span class="line">were auto-granted or (2) a platform permission in the same group is</span><br><span class="line">granted.</span><br></pre></td></tr></table></figure><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43765" target="_blank" rel="noopener">CVE-2024-43765</a> EoP High <a href="https://android.googlesource.com/platform/packages/apps/DocumentsUI/+/c8e21a60d78414aca4115403fe63fc732a9cd5aa" target="_blank" rel="noopener">1</a><br>悬浮窗覆盖漏洞再次限时回归。Document UI 这个 app 里隐藏遮盖窗体，防止点击劫持。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43763" target="_blank" rel="noopener">CVE-2024-43763</a> DoS High <a href="https://android.googlesource.com/platform/packages/modules/Bluetooth/+/124c2ac6cffb2b7c7e6c66b6def767cd74b62361%5E%21/#F0" target="_blank" rel="noopener">1</a><br>一个蓝牙的逻辑 bug，应该只会造成功能异常？</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49736" target="_blank" rel="noopener">CVE-2024-49736</a> DoS High <a href="https://android.googlesource.com/platform/packages/apps/Settings/+/779372c34f0b2928107d6ebf9165f97b4a2edc4f" target="_blank" rel="noopener">1</a><br>禁止在 DSU 模式下恢复出厂设置。可能是因为 DSU 用的 data 不一样，所以不会再要求输入一遍锁屏密码？</p><br><section class="widget copyright desktop mobile"><div class="content"><blockquote><p>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</p><p>本文永久链接是：<a href="https://blog.canyie.top/2025/01/29/android-security-bulletin-index-2025/">https://blog.canyie.top/2025/01/29/android-security-bulletin-index-2025/</a></p></blockquote></div></section></div><section class="meta" id="footer-meta"><div class="new-meta-box"><div class="new-meta-item date" itemprop="dateUpdated" datetime="2025-05-08T17:21:02+08:00"><a class="notlink"><i class="fas fa-edit fa-fw" aria-hidden="true"></i><p>更新于2025年5月8日</p></a></div><div class="new-meta-item meta-tags"><a class="tag" href="/tags/android/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>android</p></a></div><div class="new-meta-item meta-tags"><a class="tag" href="/tags/system/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>system</p></a></div><div class="new-meta-item meta-tags"><a class="tag" href="/tags/%E5%AE%89%E5%85%A8/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>安全</p></a></div><div class="new-meta-item meta-tags"><a class="tag" href="/tags/%E5%AE%89%E5%85%A8%E8%A1%A5%E4%B8%81%E5%88%86%E6%9E%90%E6%A0%8F%E7%9B%AE/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>安全补丁分析栏目</p></a></div><div class="new-meta-item share -mob-share-list"><div class="-mob-share-list share-body"><a class="-mob-share-qq" rel="external nofollow noopener noreferrer noopener" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.canyie.top/2025/01/29/android-security-bulletin-index-2025/&title=Android 2025 年每月安全补丁分析索引 - 残页的小博客&summary=2024 年度补丁分析：点我给大家分享一个好消息，经过一年的研究，我现在在 Google BugHunters 平台上总排名 32，2024 年度第 6 名，Android Program 第 6 名！感谢各位一年陪伴！最后更新时间：2025/05/08 更新内容：更新 03 04 05" target="_blank"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qq.png"> </a><a class="-mob-share-qzone" rel="external nofollow noopener noreferrer noopener" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://blog.canyie.top/2025/01/29/android-security-bulletin-index-2025/&title=Android 2025 年每月安全补丁分析索引 - 残页的小博客&summary=2024 年度补丁分析：点我给大家分享一个好消息，经过一年的研究，我现在在 Google BugHunters 平台上总排名 32，2024 年度第 6 名，Android Program 第 6 名！感谢各位一年陪伴！最后更新时间：2025/05/08 更新内容：更新 03 04 05" target="_blank"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qzone.png"> </a><a class="-mob-share-weibo" rel="external nofollow noopener noreferrer noopener" href="http://service.weibo.com/share/share.php?url=https://blog.canyie.top/2025/01/29/android-security-bulletin-index-2025/&title=Android 2025 年每月安全补丁分析索引 - 残页的小博客&summary=2024 年度补丁分析：点我给大家分享一个好消息，经过一年的研究，我现在在 Google BugHunters 平台上总排名 32，2024 年度第 6 名，Android Program 第 6 名！感谢各位一年陪伴！最后更新时间：2025/05/08 更新内容：更新 03 04 05" target="_blank"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/weibo.png"></a></div></div></div></section><div class="prev-next"><a class="prev" href="/2025/02/04/CVE-2024-49721/"><p class="title"><i class="fas fa-chevron-left" aria-hidden="true"></i>CVE-2024-49721 InputMethodSubtypeArray 反序列化漏洞分析</p><p class="content">神马，都 2025 年啦，还有 Parcel Mismatch 漏洞？！？对！你没听错！最经典最被广泛利用的 Parcel Mismatch 漏洞，它又双叒叕来了！怕了吗？！？去年我和 Cxxs...</p></a><a class="next" href="/2024/11/07/self-changing-data-type/"><p class="title">Self-changing Data Type - CVE-2024-40676 漏洞分析<i class="fas fa-chevron-right" aria-hidden="true"></i></p><p class="content">今年 10 月份的时候，Android 安全公告用 CVE-2024-40676 的编号公布了一个很奇怪的 patch。AccountManagerService checkKeyIntent(...</p></a></div></section></article><script>window.subData={title:"Android 2025 年每月安全补丁分析索引",tools:!0}</script></div><aside class="l_side"><section class="widget toc-wrapper shadow blur desktop mobile"><header><i class="fas fa-list fa-fw" aria-hidden="true"></i><span class="name">本文目录</span></header><div class="content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#2025-05-01"><span class="toc-text">2025-05-01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework"><span class="toc-text">Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#System"><span class="toc-text">System</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2025-04-01"><span class="toc-text">2025-04-01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework-1"><span class="toc-text">Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#System-1"><span class="toc-text">System</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2025-03-01"><span class="toc-text">2025-03-01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework-2"><span class="toc-text">Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#System-2"><span class="toc-text">System</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2025-02-01"><span class="toc-text">2025-02-01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework-3"><span class="toc-text">Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Platform"><span class="toc-text">Platform</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#System-3"><span class="toc-text">System</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2025-01-01"><span class="toc-text">2025-01-01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework-4"><span class="toc-text">Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Media-Framework"><span class="toc-text">Media Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#System-4"><span class="toc-text">System</span></a></li></ol></li></ol></div></section><section class="widget tagcloud shadow blur desktop mobile"><header><a href="/tags/"><i class="fas fa-tags fa-fw" aria-hidden="true"></i><span class="name">热门标签</span></a></header><div class="content"><a href="/tags/AOP/" style="font-size:15.67px;color:#8e8e8e">AOP</a> <a href="/tags/android/" style="font-size:24px;color:#555">android</a> <a href="/tags/art/" style="font-size:19px;color:#777">art</a> <a href="/tags/dex/" style="font-size:14px;color:#999">dex</a> <a href="/tags/hidden-api/" style="font-size:14px;color:#999">hidden-api</a> <a href="/tags/hook/" style="font-size:15.67px;color:#8e8e8e">hook</a> <a href="/tags/kernel/" style="font-size:15.67px;color:#8e8e8e">kernel</a> <a href="/tags/magisk/" style="font-size:17.33px;color:#828282">magisk</a> <a href="/tags/parcel/" style="font-size:14px;color:#999">parcel</a> <a href="/tags/property/" style="font-size:14px;color:#999">property</a> <a href="/tags/system/" style="font-size:22.33px;color:#606060">system</a> <a href="/tags/xposed/" style="font-size:17.33px;color:#828282">xposed</a> <a href="/tags/%E5%AE%89%E5%85%A8/" style="font-size:20.67px;color:#6c6c6c">安全</a> <a href="/tags/%E5%AE%89%E5%85%A8%E8%A1%A5%E4%B8%81%E5%88%86%E6%9E%90%E6%A0%8F%E7%9B%AE/" style="font-size:15.67px;color:#8e8e8e">安全补丁分析栏目</a> <a href="/tags/%E5%B9%B4%E9%89%B4/" style="font-size:15.67px;color:#8e8e8e">年鉴</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" style="font-size:14px;color:#999">数据结构与算法</a> <a href="/tags/%E6%B3%A8%E5%85%A5/" style="font-size:15.67px;color:#8e8e8e">注入</a> <a href="/tags/%E8%88%AA%E7%A9%BA/" style="font-size:14px;color:#999">航空</a> <a href="/tags/%E9%97%B2%E8%81%8A/" style="font-size:17.33px;color:#828282">闲聊</a></div></section></aside><footer class="clearfix"><br><br><br><div class="social-wrapper"><a href="/atom.xml" class="social fas fa-rss flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a> <a href="mailto:a1364259@163.com" class="social fas fa-envelope flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a> <a href="https://github.com/canyie" class="social fab fa-github flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a></div><div><p>博客内容遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p></div>本站使用 <a href="https://volantis.js.org/" target="_blank" class="codename">Volantis</a> 作为主题，总访问量为 <span id="busuanzi_value_site_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span> 次<div class="copyright"><p>如对本站有任何疑问或建议，欢迎到 <a href="https://github.com/canyie/canyie.github.io/issues/" target="_blank" rel="noopener">issues 区</a> 反馈~</p></div></footer><script>setLoadingBarProgress(80)</script><script>setLoadingBarProgress(60)</script></div><a class="s-top fas fa-arrow-up fa-fw" href="javascript:void(0)"></a></div><script src="https://cdn.jsdelivr.net/npm/jquery@3.4/dist/jquery.min.js"></script><script>var SEARCH_SERVICE="hexo",ROOT="/";ROOT.endsWith("/")||(ROOT+="/")</script><script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/instant_page.js" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script><script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script><script type="text/javascript">$(function(){Waves.attach(".flat-btn",["waves-button"]),Waves.attach(".float-btn",["waves-button","waves-float"]),Waves.attach(".float-btn-light",["waves-button","waves-float","waves-light"]),Waves.attach(".flat-box",["waves-block"]),Waves.attach(".float-box",["waves-block","waves-float"]),Waves.attach(".waves-image"),Waves.init()})</script><script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script><script type="text/javascript">$(function(){var a=["https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/BBC19066-E176-47C2-9D22-48C81EE5DF6B.jpeg"];!function(a){for(var t=a.length;t--;){var r=Math.floor(Math.random()*t),n=a[r];a[r]=a[t],a[t]=n}}(a),$.backstretch(a,{duration:"20000",fade:"1500"})})</script><script src="/js/app.js"></script><script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.4/js/search.js"></script><script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/comment_typing.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script><script>function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-check-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('fa-check-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-times-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('fa-times-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);</script><script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script>let LAZY_LOAD_IMAGE = "[object Object]";
  $(".article-entry").find("div.fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });</script><script>setLoadingBarProgress(100)</script><script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var i=n.imageLazyLoadSetting.isSPA,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){i&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,e,a=0;a<r.length;a++)t=r[a],e=void 0,0<=(e=t.getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(n.innerHeight||document.documentElement.clientHeight)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},n.src=i}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script></body></html>