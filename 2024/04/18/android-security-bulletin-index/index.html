<!DOCTYPE html><html><head hexo-theme="https://volantis.js.org/#2.5.1"><meta charset="utf-8"><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="HandheldFriendly" content="True"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>Android 2024 每月安全补丁分析索引 - 残页的小博客</title><meta name="keywords" content="android,system,安全,安全补丁分析栏目"><meta name="description" content="之前一直在看的每月补丁分析的博客 https://wrlus.com/ 看起来是不再更新了，想了想反正自己每个月也要去追着看，干脆写一下分析得了，方便自己后面找。本人很菜，分析的大部分都是 Java 层漏洞，大佬别骂我 QAQ最初发表在我的 telegram 频道。每月补丁都会在此文中更新。2025 年度补丁分析..."><link rel="alternate" href="/atom.xml" title="残页的小博客"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css"><link rel="shortcut icon" type="image/x-icon" href="/data/image/favicon.ico"><link rel="stylesheet" href="/css/style.css"><script>function setLoadingBarProgress(e){document.getElementById("loading-bar").style.width=e+"%"}</script></head><body><div id="loading-bar-wrapper"><div id="loading-bar"></div></div><header class="l_header shadow blur"><div class="container"><div class="wrapper"><div class="nav-sub"><p class="title"></p><ul class="switcher nav-list-h"><li><a class="s-comment fas fa-comments fa-fw" target="_self" href="javascript:void(0)"></a></li><li><a class="s-toc fas fa-list fa-fw" target="_self" href="javascript:void(0)"></a></li></ul></div><div class="nav-main"><a class="title flat-box" target="_self" href="/">残页的小博客</a><div class="menu navigation"><ul class="nav-list-h"><li><a class="flat-box" href="/" id="home"><i class="fas fa-rss fa-fw"></i>博客</a></li><li><a class="flat-box" href="/tags/" id="tags"><i class="fas fa-tags fa-fw"></i>标签</a></li><li><a class="flat-box" href="/archives/" id="archives"><i class="fas fa-archive fa-fw"></i>归档</a></li><li><a class="flat-box" href="/friends/" id="friends"><i class="fas fa-link fa-fw"></i>友链</a></li><li><a class="flat-box" href="/about/" id="about"><i class="fas fa-info-circle fa-fw"></i>关于</a></li></ul></div><div class="m_search"><form name="searchform" class="form u-search-form"><i class="icon fas fa-search fa-fw"></i> <input type="text" class="input u-search-input" placeholder="搜索……"></form></div><ul class="switcher nav-list-h"><li><a class="s-search fas fa-search fa-fw" target="_self" href="javascript:void(0)"></a></li><li><a class="s-menu fas fa-bars fa-fw" target="_self" href="javascript:void(0)"></a><ul class="menu-phone list-v navigation white-box"><li><a class="flat-box" href="/" id="home"><i class="fas fa-rss fa-fw"></i>博客</a></li><li><a class="flat-box" href="/tags/" id="tags"><i class="fas fa-tags fa-fw"></i>标签</a></li><li><a class="flat-box" href="/archives/" id="archives"><i class="fas fa-archive fa-fw"></i>归档</a></li><li><a class="flat-box" href="/friends/" id="friends"><i class="fas fa-link fa-fw"></i>友链</a></li><li><a class="flat-box" href="/about/" id="about"><i class="fas fa-info-circle fa-fw"></i>关于</a></li></ul></li></ul></div></div></div></header><script>setLoadingBarProgress(40)</script><div class="l_body nocover"><div class="body-wrapper"><div class="l_main"><article id="post" class="post white-box shadow blur article-type-post" itemscope itemprop="blogPost"><section class="meta"><div class="meta" id="header-meta"><h1 class="title"><a href="/2024/04/18/android-security-bulletin-index/">Android 2024 每月安全补丁分析索引</a></h1><div class="new-meta-box"><div class="new-meta-item author"><a href="https://blog.canyie.top/" rel="nofollow"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/data/image/avatar_new.jpg"><p>canyie</p></a></div><div class="new-meta-item date"><a class="notlink"><i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i><p>发布于2024年4月18日</p></a></div><div class="new-meta-item wordcount"><a class="notlink"><i class="fas fa-keyboard fa-fw" aria-hidden="true"></i><p>字数：10.4k字</p></a></div><div class="new-meta-item readtime"><a class="notlink"><i class="fas fa-hourglass-half fa-fw" aria-hidden="true"></i><p>时长：41分钟</p></a></div><div class="new-meta-item browse busuanzi"><a class="notlink"><i class="fas fa-eye fa-fw" aria-hidden="true"></i><p><span id="busuanzi_value_page_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></p></a></div></div><hr></div></section><section class="article typo"><div class="article-entry" itemprop="articleBody"><p>之前一直在看的每月补丁分析的博客 <a href="https://wrlus.com/" target="_blank" rel="noopener">https://wrlus.com/</a> 看起来是不再更新了，想了想反正自己每个月也要去追着看，干脆写一下分析得了，方便自己后面找。</p><p>本人很菜，分析的大部分都是 Java 层漏洞，大佬别骂我 QAQ</p><p>最初发表在我的 telegram 频道。每月补丁都会在此文中更新。</p><p>2025 年度补丁分析：<a href="https://blog.canyie.top/2025/01/29/android-security-bulletin-index-2025/">点我</a></p><p>最后更新时间：2025/01/29 更新内容：添加 2025 年度链接</p><a id="more"></a><h2 id="2024-12-01"><a href="#2024-12-01" class="headerlink" title="2024-12-01"></a>2024-12-01</h2><p>不知不觉，这个栏目竟然就开了整整一年了，说实话我自己都没想到我竟然能坚持一年，感谢大家一直以来的陪伴！<br>经过一年更新，这篇文章已经过长，从 2025 年开始将开一个新的文章进行更新，以后应该每年都会开新文章。我们明年再见！<br>另外为什么这个月补丁这么少？才六个，跟以前的完全不是一个量级</p><h3 id="Framework"><a href="#Framework" class="headerlink" title="Framework"></a>Framework</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43762" target="_blank" rel="noopener">CVE-2024-43762</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/ae43ac7f3d3d5112b0f54b5315a15b08208acf9c" target="_blank" rel="noopener">1</a><br>此漏洞由我发现并报告。<br>App Widget Service 绑定到 app 的 service 时没有正确处理 onNullBinding，会导致连接不会被销毁。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43764" target="_blank" rel="noopener">CVE-2024-43764</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/70eb75df7d342429c3ee225feb7c011df727442f" target="_blank" rel="noopener">1</a><br>设备没解锁的时候禁止进入交互式剪贴板页面，否则可能让接触到设备的攻击者通过剪贴板里已有的 intent 逃逸出锁屏。其实应该还有信息泄漏？</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43769" target="_blank" rel="noopener">CVE-2024-43769</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/619ffc299bf33566ba6daee8301ee0fc96e015f4" target="_blank" rel="noopener">1</a><br><del>还有高手（？？</del><br>如果 Device Management 这个 role 的持有者是系统应用，在其他用户也将其当作 device admin 而非仅在它所在的用户，因为 apk 的版本是跨用户全局共享的，在一个无关用户选择卸载更新会影响其他受管用户，对设备管理功能造成潜在影响，应该禁止。<br>Device Management Role 这个功能其实没看见有多少人用，应该还是传统的 device owner / profile owner 用的人比较多。</p><h3 id="System"><a href="#System" class="headerlink" title="System"></a>System</h3><p>三个都是 libskia 中的内存漏洞，这种情况还是很少见的。简单看了一下和上个月的 CVE-2024-43091 基本类似，致谢信息也都是 Google 的同一个人，应该是代码审查的时候看见的。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43767" target="_blank" rel="noopener">CVE-2024-43767</a> RCE High <a href="https://android.googlesource.com/platform/external/skia/+/796c2040f641bb287dba66c9823ce45e9f8b5807" target="_blank" rel="noopener">1</a><br>SkBlurMF.cpp 有一个地方调用了 computeImageSize() 计算要分配的大小，但没检查计算时发生溢出的情况（这个时候会返回 0），会在下方分配出大小为 0 的内存。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43097" target="_blank" rel="noopener">CVE-2024-43097</a> EoP High <a href="https://android.googlesource.com/platform/external/skia/+/8d355fe1d0795fc30b84194b87563f75c6f8f2a7" target="_blank" rel="noopener">1</a><br>SkRegion.cpp 内计算分配内存大小时可能会发生溢出。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43768" target="_blank" rel="noopener">CVE-2024-43768</a> EoP High <a href="https://android.googlesource.com/platform/external/skia/+/b5543cb8c6b95623743016055220378efe73eb93" target="_blank" rel="noopener">1</a><br>src/pdf/SkDeflate.cpp skia_alloc_func 更加严格地校验 size 和 items，看起来也是类似的问题，防止数学计算产生非预期的结果进而导致分配的内存大小小于预期。<br>P.S. 感兴趣的人还可以看看 SkTFitsIn 这个函数的实现，我看了一眼，感觉非常仙人</p><h2 id="2024-11-01"><a href="#2024-11-01" class="headerlink" title="2024-11-01"></a>2024-11-01</h2><h3 id="Framework-1"><a href="#Framework-1" class="headerlink" title="Framework"></a>Framework</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-40660" target="_blank" rel="noopener">CVE-2024-40660</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/native/+/064ce6e3235b6318be1e41f1bac9595a98e4aafa" target="_blank" rel="noopener">1</a> <a href="https://android.googlesource.com/platform/frameworks/native/+/064ce6e3235b6318be1e41f1bac9595a98e4aafa" target="_blank" rel="noopener">2</a><br>看起来是和 CVE-2024-34743 类似的问题，引用拷贝写成了值拷贝。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43081" target="_blank" rel="noopener">CVE-2024-43081</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/31c098c4271ad4fdfb3809e05017ead8d9f6580f" target="_blank" rel="noopener">1</a><br>此漏洞由我发现并报告。<br>此漏洞是 CVE-2024-0046 的变体，当时的补丁只限制了系统 app 不能被安装为 instant app，很容易能想到除了系统 app，设备管理 app 也不应该被限制，直接又提了个报告。补丁加上了 device admin app 和被保护的 app 的检测。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43085" target="_blank" rel="noopener">CVE-2024-43085</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/2457d4e459ee6ffd099b9ff7cce9c83119c3ce66" target="_blank" rel="noopener">1</a><br>USB 传输模式切换超时的时候，如果当前处于 Accessory 模式，不应该继续保持在这个模式，以阻止 USB 设备继续通过 Android Open Accessory 协议和 Android 设备进行交互。<br>Android Open Accessory 文档：<a href="https://source.android.com/docs/core/interaction/accessories/protocol" target="_blank" rel="noopener">https://source.android.com/docs/core/interaction/accessories/protocol</a></p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43093" target="_blank" rel="noopener">CVE-2024-43093</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/67d6e08322019f7ed8e3f80bd6cd16f8bcb809ed" target="_blank" rel="noopener">1</a><br>此漏洞由 LSPosed 团队报告。<br>在传入的 URI 中插入 Unicode 可忽略代码点可绕过 /sdcard/Android/data 访问限制。技术细节：<a href="https://t.me/vvb2060Channel/855" target="_blank" rel="noopener">https://t.me/vvb2060Channel/855</a></p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43082" target="_blank" rel="noopener">CVE-2024-43082</a> ID High <a href="https://android.googlesource.com/platform/frameworks/base/+/6aa1b4fbf5936a1ff5bdbb79397c94910a6ed8f5" target="_blank" rel="noopener">1</a><br>设置新用户头像时检查返回的 URI，避免出现跨用户读取。<br>这个地方我之前尝试过利用，但是没成功，没能拦截到任何一个 intent，不知道漏洞的作者是怎么做到的。看补丁只给 12 12L 更新了，可能是安卓大版本的行为差异导致。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43084" target="_blank" rel="noopener">CVE-2024-43084</a> ID High <a href="https://android.googlesource.com/platform/frameworks/base/+/50eec20b570cd4cbbe8c5971af4c9dda3ddcb858" target="_blank" rel="noopener">1</a><br>NotificationManagerService 检查 notification URI 的时候，如果它带有 Person 对象，不仅要检查它的 Icon URI 还要检查 mUri。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43086" target="_blank" rel="noopener">CVE-2024-43086</a> ID High <a href="https://android.googlesource.com/platform/frameworks/base/+/55a3d36701bb874358f685d3ac3381eda10fcff0" target="_blank" rel="noopener">1</a><br>如果账号的 authenticator uid 发生改变，清掉对应账号类型的所有数据。看起来是 AccountManagerService 里的数据能悬空。</p><h3 id="System-1"><a href="#System-1" class="headerlink" title="System"></a>System</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43091" target="_blank" rel="noopener">CVE-2024-43091</a> RCE High <a href="https://android.googlesource.com/platform/external/skia/+/0b628a960e74197ace9831ef0727f5ba7ab6ac10" target="_blank" rel="noopener">1</a><br>libskia 的一个整数溢出问题，之前的代码只检查了 <code>dst-&gt;computeImageSize()</code> 的结果没溢出，但下面分配了 size 乘三倍的内存，这里有可能发生溢出导致分配到的内存空间小于预期，进而发生越界写。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-29779" target="_blank" rel="noopener">CVE-2024-29779</a> EoP High <a href="https://android.googlesource.com/platform/system/keymint/+/1f6bf0cae40c1076faa39707c56d3994e73d01e2" target="_blank" rel="noopener">1</a><br>没太看懂，看起来是代码里实现了 Keymint3 的 ATTESTATION_ID_SECOND_IMEI 但是忘记启用的样子</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34719" target="_blank" rel="noopener">CVE-2024-34719</a> EoP High <a href="https://android.googlesource.com/platform/packages/modules/Bluetooth/+/b0e4375577ba7e21bd40edac5990bea418ecdc8c" target="_blank" rel="noopener">1</a><br>蓝牙组件里禁止传入的 AttributionSource 是 null 的情况，因为蓝牙依赖 AttributionSource 检查调用者权限，传 null 的时候不会触发 AttributionSource 反序列化也就不会触发权限校验流程。<br>题外话：这个 bug 的 id 是 242996380，估计都是两年前的了，这个处理速度，我也不直接评价了，我就给四个字，令人咋舌</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-40661" target="_blank" rel="noopener">CVE-2024-40661</a> EoP High <a href="https://android.googlesource.com/platform/packages/modules/Permission/+/ffd81f212b5594b498f0ba07645c7a181540e494" target="_blank" rel="noopener">1</a><br>device admin 不允许主动授予隐私相关的权限，比如录音照相和位置权限，这个检查要把权限的权限组一起纳入检查，而不是只检查权限名。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43080" target="_blank" rel="noopener">CVE-2024-43080</a> EoP High <a href="https://android.googlesource.com/platform/packages/apps/Settings/+/26ce013dfd7e59a451acc66e7f05564e0884d46b" target="_blank" rel="noopener">1</a><br>此漏洞由我发现并报告。<br>Settings AppRestrictionsFragment 接收 app 传回的原始 intent 之后不能直接传给 startActivity，避免在 AIDL 调用过程中出现类型混淆污染后续数据。<br>更多可参考 <a href="https://konata.github.io/posts/creator-mismatch/" target="_blank" rel="noopener">https://konata.github.io/posts/creator-mismatch/</a></p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43087" target="_blank" rel="noopener">CVE-2024-43087</a> EoP High <a href="https://android.googlesource.com/platform/packages/apps/Settings/+/6253b87704bb097ad9963941bdddf3b86906a73e" target="_blank" rel="noopener">1</a><br>Settings AccessibilitySettings 显示无障碍服务列表的时候会过滤 service label 和 activity label 相同的服务，导致其被隐藏不显示而仍然拥有无障碍权限。<br>这个处理看不懂原本是干啥的，完全多此一举，补丁就是删掉了对应代码。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43088" target="_blank" rel="noopener">CVE-2024-43088</a> EoP High <a href="https://android.googlesource.com/platform/packages/apps/Settings/+/975c28535419be1cc45f66712f41e4a7a40e6001" target="_blank" rel="noopener">1</a><br>此漏洞由我发现并报告。<br>Settings 中 AppInfoBase 是一个 base fragment，接收调用者指定的 user handle 然后直接使用，全程没进行任何检查，导致可以指定任意用户从而代表其他用户修改其 app 的权限。补丁加了个检查保证调用者必须要有 INTERACT_ACROSS_USERS_FULL 权限。<br>这个漏洞是我之前编写 <a href="https://blog.canyie.top/2024/11/05/android-platform-common-vulnerabilities/">Android 平台常见安全漏洞类型</a> 的时候注意到 CVE-2023-21107 这个相似的漏洞，顺便搜索了一下涉及的 Intent.EXTRA_USER_HANDLE 还有没有其他地方有引用，然后就让我发现了这个一模一样的漏洞，属于是白捡天上掉下来的钱了。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43089" target="_blank" rel="noopener">CVE-2024-43089</a> EoP High <a href="https://android.googlesource.com/platform/packages/providers/MediaProvider/+/33ff6a663eea1fcdd2b422b98722c1dee48a7f6a" target="_blank" rel="noopener">1</a><br>MediaProvider 中，app 尝试重命名文件时需要检查其权限，以免在 MediaProvider 数据库中留下虚假的记录，让 app 可以读写原本不属于它的文件。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43090" target="_blank" rel="noopener">CVE-2024-43090</a> ID High <a href="https://android.googlesource.com/platform/frameworks/base/+/4677d3ee0ec2d31acc6108fea7be6cced971da37" target="_blank" rel="noopener">1</a><br>此漏洞由我发现并报告。<br>Android 有一个功能叫做 keyboard shortcuts helper，其实现是系统向当前前台 app 收集可用快捷键，然后交由 SystemUI 把它渲染出来，其包含着一个隐藏的 Icon 对象，可以使用反射进行修改。补丁表示这个功能不应该由 app 使用，直接清空了所有 app 提供的 icon。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43083" target="_blank" rel="noopener">CVE-2024-43083</a> DoS High <a href="https://android.googlesource.com/platform/packages/modules/Wifi/+/62f61e19524e9a55cadd1116c9448ff34b977e50" target="_blank" rel="noopener">1</a><br>WiFi 模块中忘记校验提供的 WifiConfiguration 中的多个字段，可能引发拒绝服务，应该是内存资源耗尽。最近这种漏洞是真的多，几乎每个月都能看见。</p><h2 id="2024-10-01"><a href="#2024-10-01" class="headerlink" title="2024-10-01"></a>2024-10-01</h2><h3 id="Framework-2"><a href="#Framework-2" class="headerlink" title="Framework"></a>Framework</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-0044" target="_blank" rel="noopener">CVE-2024-0044</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/954b2874b85b6cd0d6bb12cd677cdf22e5dbd77b" target="_blank" rel="noopener">1</a> <a href="https://android.googlesource.com/platform/frameworks/base/+/836750619a8bce0bf78fe0549f9990e294671563" target="_blank" rel="noopener">2</a><br>是不是感觉这个 CVE 号很熟悉？对，这个漏洞在三月公告里就放过一次。后面我发现原补丁给的修复并不充分重新发送了一个报告，给这个三月份就应该被修复的漏洞续命到了十月。<br>更多细节可以参考我的 PoC &amp; writeup： <a href="https://github.com/canyie/CVE-2024-0044" target="_blank" rel="noopener">https://github.com/canyie/CVE-2024-0044</a></p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-40676" target="_blank" rel="noopener">CVE-2024-40676</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/e8a53246607b52b15269f97aef9ba7e928ba2473" target="_blank" rel="noopener">1</a><br>AccountManagerService checkKeyIntent 内添加新的检查，拒绝所有 data 带有 content URI 的 intent。<br>好暴力的补丁，让人摸不着头脑，一开始以为是 URI grant，仔细研究之后发现还不是，问题比较复杂，利用非常精妙，准备以后单独写一篇文章描述这个问题（挖坑+1）。<br>更新：已经给出完整分析，可查看 <a href="http://blog.canyie.top/2024/11/07/self-changing-data-type/">http://blog.canyie.top/2024/11/07/self-changing-data-type/</a></p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-40675" target="_blank" rel="noopener">CVE-2024-40675</a> DoS High <a href="https://android.googlesource.com/platform/frameworks/base/+/c6b5490ec659b5854fd429f453f75de5befa6359" target="_blank" rel="noopener">1</a><br>把 URI 解析成 Intent 的时候检查里面每个字段的结尾分号是否存在，不存在则直接终止解析并抛出 URISyntaxException。</p><h3 id="System-2"><a href="#System-2" class="headerlink" title="System"></a>System</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-40673" target="_blank" rel="noopener">CVE-2024-40673</a> RCE High <a href="https://android.googlesource.com/platform/libcore/+/b17fd2f8fe468e7d32e713b442f610cd33e4e7a9%5E%21/#F0" target="_blank" rel="noopener">1</a><br>Java ZipFile API 拒绝文件头无效的 zip 文件。更多请参阅发现者的博客：<a href="https://wrlus.com/android-security/cve-2024-40673/" target="_blank" rel="noopener">https://wrlus.com/android-security/cve-2024-40673/</a></p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-40672" target="_blank" rel="noopener">CVE-2024-40672</a> EoP High <a href="https://android.googlesource.com/platform/packages/modules/IntentResolver/+/ccd29124d0d2276a3071c0418c14dec188cd3727" target="_blank" rel="noopener">1</a><br>设置向导结束之前不允许打开 ChooserActivity，避免 FRP 绕过。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-40677" target="_blank" rel="noopener">CVE-2024-40677</a> EoP High <a href="https://android.googlesource.com/platform/packages/apps/Settings/+/db26138f07db830e3fb78283d37de3c0296d93cb" target="_blank" rel="noopener">1</a><br>设置向导结束之前不允许打开“应用电池用量”的管理页面，避免 FRP 绕过。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-40674" target="_blank" rel="noopener">CVE-2024-40674</a> DoS High <a href="https://android.googlesource.com/platform/packages/modules/Wifi/+/debc548ac085ba1ab0582172b97d965e9a1ea43a" target="_blank" rel="noopener">1</a><br>插入 WifiConfiguration 的时候，如果 SSID 以引号开头，之前的代码不会检查它的长度，可以导致拒绝服务。补丁就是加上了这种情况的检查。只影响 14。</p><h2 id="2024-09-01"><a href="#2024-09-01" class="headerlink" title="2024-09-01"></a>2024-09-01</h2><p>这个栏目不如改叫每月安全补丁提交信息翻译 都没啥分析了<br>已知被在野利用漏洞：CVE-2024-32896</p><h3 id="Framework-3"><a href="#Framework-3" class="headerlink" title="Framework"></a>Framework</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-32896" target="_blank" rel="noopener">CVE-2024-32896</a> EoP High <a href="https://android.googlesource.com/platform/system/sepolicy/+/92cbf8d4f18ccb2c488f50b7300bd6bfc33023aa" target="_blank" rel="noopener">1</a> <a href="https://android.googlesource.com/platform/frameworks/base/+/8b7b2c66ca96d711fb364cbcc9d655197d9743e0" target="_blank" rel="noopener">2</a><br>恢复出厂设置时，在重启到 recovery 之前删除 data 分区加密密钥，保证重启失败（比如按音量键导致设备提前进入 bootloader 模式而非 recovery）时设备数据也无法被恢复。此漏洞已知正在被数据取证公司在野利用。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-40658" target="_blank" rel="noopener">CVE-2024-40658</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/av/+/6d23fa05a40e5462d4b9bad28afa932e6e12a4f3" target="_blank" rel="noopener">1</a><br>libstagefright 中处理 HDR10+ 视频的一个越界写入问题。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-40662" target="_blank" rel="noopener">CVE-2024-40662</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/e7af00cafb52a25933ec4edb80c5111d42af0237" target="_blank" rel="noopener">1</a><br>解析 uri 时移除 scheme 中的 “://” 字符串。</p><h3 id="System-3"><a href="#System-3" class="headerlink" title="System"></a>System</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-40650" target="_blank" rel="noopener">CVE-2024-40650</a> EoP High <a href="https://android.googlesource.com/platform/packages/apps/Settings/+/2968ccc911956fa5813a9a6a5e5c8970e383a60f" target="_blank" rel="noopener">1</a><br>设置应用中编辑 wifi 信息时限制最长只能输入 500 个字符，看漏洞描述是能 crash Settings 从而绕过 FRP</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-40652" target="_blank" rel="noopener">CVE-2024-40652</a> EoP High <a href="https://android.googlesource.com/platform/packages/apps/Settings/+/2909433f7d59dcdd0c74044b1c8e9f48927193dc" target="_blank" rel="noopener">1</a><br>设置向导结束之前如果尝试启动系统设置，直接关闭</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-40654" target="_blank" rel="noopener">CVE-2024-40654</a> EoP High <a href="https://android.googlesource.com/platform/packages/apps/Settings/+/f1d0079c91734168c150f839168544f407b17b06" target="_blank" rel="noopener">1</a><br>补丁链接跟五月份的 CVE-2024-23707 是一样的，不知道为什么又放了一遍。<br>更新：注意到之前的补丁只给 14 更新了，这次给 12-14 都更新了，应该是解决 14 之前版本没打补丁的问题。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-40655" target="_blank" rel="noopener">CVE-2024-40655</a> EoP High <a href="https://android.googlesource.com/platform/packages/services/Telecomm/+/eeef54b37a362f506ea3aa155baddc545b6a909a" target="_blank" rel="noopener">1</a><br>绑定 CallScreenService 超时了也需要 unbind。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-40657" target="_blank" rel="noopener">CVE-2024-40657</a> EoP High <a href="https://android.googlesource.com/platform/packages/apps/Settings/+/8261e0ade3b414fea61d7fe9d8bc6df7a3fc8603" target="_blank" rel="noopener">1</a><br>Settings 加载应用定义的账号配置页面时，由于是直接解析 xml 然后加载，android:fragment 这个属性也会生效，从而可以调起 Settings 内的任意 fragment。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-40656" target="_blank" rel="noopener">CVE-2024-40656</a> ID High <a href="https://android.googlesource.com/platform/packages/services/Telecomm/+/f3e6a6c02439401eb7aeb3749ee5ec0b51a625b9" target="_blank" rel="noopener">1</a><br>ConnectionService createConference 忘了检查传入的 StatusHints 是否包含跨用户的 icon。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-40659" target="_blank" rel="noopener">CVE-2024-40659</a> DoS High <a href="https://android.googlesource.com/platform/packages/modules/RemoteKeyProvisioning/+/c65dce4c6d8d54e47dce79a56e29e2223a2354e6" target="_blank" rel="noopener">1</a><br>RKP app 的 RemoteProvisioningService 限制只能 system server 才能 bind。<br>这个漏洞我们很早就注意到了，但是研究之后觉得没有安全风险就没报，结果是高危漏洞，痛失 7000 😭 虽然没看懂咋触发 DoS，看描述是可以为其他应用上传密钥从而持久禁用相关功能。<br>关于 RKP 的功能说明：<a href="https://t.me/vvb2060Channel/812" target="_blank" rel="noopener">https://t.me/vvb2060Channel/812</a></p><h2 id="2024-08-01"><a href="#2024-08-01" class="headerlink" title="2024-08-01"></a>2024-08-01</h2><p>可能被在野利用的漏洞：CVE-2024-36971，内核的一个 UAF 漏洞<br>（严重怀疑打错了，可能想写的是 CVE-2024-34735）</p><h3 id="Framework-4"><a href="#Framework-4" class="headerlink" title="Framework"></a>Framework</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-20971" target="_blank" rel="noopener">CVE-2023-20971</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/6c22d6c1e69676c5c68d21928aa5486bfd1bd131" target="_blank" rel="noopener">1</a><br>PermissionManagerServiceImpl 中，有个判断看是不是尝试移除非动态的权限，结果只有个 log 忘了 return。<br>这个 CVE 去年在 Pixel 六月公告就出现过，当时评的是 moderate，给 13 更新了，结果这次奇怪地给 14 也更新了，补丁是今年创建的，里面的 android id 也跟公告里的对不上，翻 CVE 描述也是说问题在 updatePermissionTreeSourcePackage 里而非补丁改的 removePermission，怀疑根本就不是同一个问题，不知道为啥复用了 CVE ID。</p><blockquote><p>Summary：privilege escalation - obtain dangerous system permissions silently utilizing the <code>&lt;permission-tree&gt;</code> element<br>Details：In removePermission of PermissionManagerServiceImpl.java, there is a possible way to obtain dangerous permissions without user consent due to a logic error in the code. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is not needed for exploitation.</p></blockquote><blockquote><p>In updatePermissionTreeSourcePackage of PermissionManagerServiceImpl.java, there is a possible way to obtain dangerous permissions without user consent due to a logic error in the code. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is not needed for exploitation.Product: AndroidVersions: Android-13Android ID: A-225880325</p></blockquote><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-21351" target="_blank" rel="noopener">CVE-2023-21351</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/26522c0e82fd3a9bcbd01409217291d97dcdabcf" target="_blank" rel="noopener">1</a><br>跟 CVE-2024-0034 类似，给 Android 14 以下系统的，绑定到 TextToSpeech Service，Job Service，Print Service，Sync Service 和 MediaRoute2Provider Service 的时候指定 flag 阻止 BAL<br>（早不给，这都24年8月了才给）</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34731" target="_blank" rel="noopener">CVE-2024-34731</a> EoP High <a href="https://android.googlesource.com/platform/hardware/interfaces/+/0ff19d1f89614fce9454fb415bcbfcbcf3caf76e" target="_blank" rel="noopener">1</a> <a href="https://android.googlesource.com/platform/frameworks/av/+/4b68b00993849b6a7f0e6d075bc2c8bb2e184e61" target="_blank" rel="noopener">2</a> <a href="https://android.googlesource.com/platform/hardware/interfaces/+/d63d09261806f7f1aa01406867f2a9e169356fca" target="_blank" rel="noopener">3</a> <a href="https://android.googlesource.com/platform/system/security/+/d3805312d73433e34ef69a645b553a2969c5dc93" target="_blank" rel="noopener">4</a> <a href="https://android.googlesource.com/platform/system/nfc/+/1037992b9abcde1e3560bd895f62644a68563b3d%5E%21/#F0" target="_blank" rel="noopener">5</a><br>同时修改了五个模块（health HAL、libmediatranscoding、neuralnetworks、keystore2、nfc）的代码，看起来是对 Binder DeathRecipient cookie 的管理问题。<br>去翻了一下文档，AIBinder_unlinkToDeath 的文档里有这句话：</p><blockquote><p>Be aware that it is not safe to immediately deallocate the cookie when this call returns. If you need to clean up the cookie, you should do so in the onUnlinked callback, which can be set using AIBinder_DeathRecipient_setOnUnlinked.</p></blockquote><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34734" target="_blank" rel="noopener">CVE-2024-34734</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/207584fb6f820eba14251251d7e9331bfd57adb8%5E%21/#F0" target="_blank" rel="noopener">1</a><br>锁屏的时候下拉状态栏，点开 Active apps，里面会显示当前活跃的应用，右边有个 Stop 按钮停止进程，用这种方式可以杀掉 VPN app。应该改成先解锁再显示。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34735" target="_blank" rel="noopener">CVE-2024-34735</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/26522c0e82fd3a9bcbd01409217291d97dcdabcf" target="_blank" rel="noopener">1</a><br>补丁链接跟 CVE-2023-21351 是一样的。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34737" target="_blank" rel="noopener">CVE-2024-34737</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/8b473b3f79642f42eeeffbfe572df6c6cbe9d79e" target="_blank" rel="noopener">1</a><br>限制 app 一分钟只能修改 60 次 PiP aspect ratio，否则 “could result flood of PiP resizing requests and freeze the PiP window”。怀疑是导致 pip 窗口渲染异常，使得其不可见，从而在用户无感知的情况下长期持有前台权限。<br>setAspectRatio 文档：<a href="https://developer.android.com/reference/android/app/PictureInPictureParams.Builder#setAspectRatio(android.util.Rational)" target="_blank" rel="noopener">https://developer.android.com/reference/android/app/PictureInPictureParams.Builder#setAspectRatio(android.util.Rational)</a><br>更新：有人复现了这个漏洞，见 <a href="https://blog.lleavesg.top/article/EvilPiP#1153fb9e943280f5ae27d6c44fc85d79" target="_blank" rel="noopener">https://blog.lleavesg.top/article/EvilPiP#1153fb9e943280f5ae27d6c44fc85d79</a></p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34738" target="_blank" rel="noopener">CVE-2024-34738</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/21d764807b3dcd402d63e2b4c9fbae1c9965400a" target="_blank" rel="noopener">1</a><br>如果调用者没有 GET_APP_OPS_STATS 特权，不返回被标记了 restrictRead 的 Op。简单搜索只找到 ACCESS_RESTRICTED_SETTINGS 一项是 restricted 的，不知道具体有什么作用。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34739" target="_blank" rel="noopener">CVE-2024-34739</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/50e1f8f36e32928d10e72324c05a203a6db9f7fb" target="_blank" rel="noopener">1</a><br>设置向导未完成时，插入 USB 设备不弹出 activity，避免 FRP 绕过。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34740" target="_blank" rel="noopener">CVE-2024-34740</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/libs/modules-utils/+/700c28908051ceb55e1456d2d21229bc17c6895a" target="_blank" rel="noopener">1</a> <a href="https://android.googlesource.com/platform/frameworks/base/+/e8b6505647be558ed3a167a1e13c53dfc227d22b" target="_blank" rel="noopener">2</a><br>FastDataOutput 内会检查一次写入的字符串数据不能超过 65535 个字节，但 BinaryXmlSerializer 中 attributeBytesHex 与 attributeBytesBase64 两个方法会按照 byte[] 写入，走这条路径是没有检查的。这两个方法会将 value 的长度作为一个 unsigned short 写入，如果 length &gt; 65535 就会丢失高位的数据，之后将 value 作为 byte[] 整体写入。下次开机时使用 BinaryXmlPullParser 读取并解析该文件，先读数据长度（unsigned short）再读对应大小的数据，会导致数据没被完全消耗完，后续解析出来的数据被污染，合理利用可以实现注入。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34741" target="_blank" rel="noopener">CVE-2024-34741</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/abfaf702ef833dc4d374492d45c615c6e6de7f01" target="_blank" rel="noopener">1</a><br>WindowState setForceHideNonSystemOverlayWindowIfNeeded 内要检查父窗口的属性，否则 SAW 窗口下的其他类型子窗口不会被隐藏</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34743" target="_blank" rel="noopener">CVE-2024-34743</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/native/+/3f85323b27d95a57bfa87cbf68dd4a143f9f88ad" target="_blank" rel="noopener">1</a><br>surfaceflinger 内遍历 states 时写成了值拷贝，然后 sanitize 事实上不会影响到原来的对象，应该改成用引用。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34736" target="_blank" rel="noopener">CVE-2024-34736</a> ID High <a href="https://android.googlesource.com/platform/frameworks/av/+/6cfd048292b2cc706811a22c9078208cfa8e6d24%5E%21/#F0" target="_blank" rel="noopener">1</a><br>StagefrightRecoder 在音源为麦克风且视频源为 surface（设备画面？）时禁用 B 帧支持，否则会出现不同步。音视频超出了我的知识体系，没办法啊~~</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34742" target="_blank" rel="noopener">CVE-2024-34742</a> DoS High <a href="https://android.googlesource.com/platform/frameworks/base/+/688e5c3012eb0a4ea88361588cf5026c10e4a42c" target="_blank" rel="noopener">1</a><br>更改逻辑保证数据始终被写入到 device_owners2.xml 。只影响14，应该跟之前的 CVE-2024-0047 是类似的问题。</p><h3 id="System-4"><a href="#System-4" class="headerlink" title="System"></a>System</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34727" target="_blank" rel="noopener">CVE-2024-34727</a> ID High <a href="https://android.googlesource.com/platform/packages/modules/Bluetooth/+/6afad4b377b5bc3f38b28296e746b674173f99d8" target="_blank" rel="noopener">1</a><br>蓝牙 sdp_utils.cc 中检查 p_attr-&gt;attr_len_type 是否为预期，防止后续缓冲区溢出。</p><h2 id="2024-07-01"><a href="#2024-07-01" class="headerlink" title="2024-07-01"></a>2024-07-01</h2><p>已知被利用漏洞：<a href="https://nvd.nist.gov/vuln/detail/CVE-2024-4610" target="_blank" rel="noopener">Arm Mali GPU Kernel Driver Use-After-Free Vulnerability CVE-2024-4610</a><br>（Android 安全公告未发出警告，信息来源于 CISA Known Exploited Vulnerabilities Catalog）</p><h3 id="Framework-5"><a href="#Framework-5" class="headerlink" title="Framework"></a>Framework</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31320" target="_blank" rel="noopener">CVE-2024-31320</a> EoP Critical <a href="https://android.googlesource.com/platform/frameworks/base/+/9722ce9d733edab76163fbcd21b231424e3d7061" target="_blank" rel="noopener">1</a> <a href="https://android.googlesource.com/platform/frameworks/base/+/df49e0e3083b0707e2cca5a5956b49f14ded078e" target="_blank" rel="noopener">2</a><br>CompanionDeviceManagerService 处理配对请求时接受一个 AssociationRequest，里面包含一个变量 <code>mSkipPrompt</code> 可以跳过用户确认，原本预期这个值只应该由系统设置，但代码里出现逻辑错误，<code>mayAssociateWithoutPrompt</code> 返回 false 时没有覆盖掉 app 设置的值。只影响 Android 13 以前。<br>这个严重给的名副其实，可惜我的 CVE-2024-31318 没给严重 😭</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31331" target="_blank" rel="noopener">CVE-2024-31331</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/c8694bbccfb9c19aefed536ea710230107c935eb" target="_blank" rel="noopener">1</a><br>调用 <code>setMimeGroup</code> 成功后要发送 ACTION_PACKAGE_CHANGED 广播。不懂不发送会有什么问题。漏洞描述：</p><blockquote><p>In setMimeGroup of PackageManagerService.java, there is a possible way to hide the service from Settings due to a logic error in the code. This could lead to local escalation of privilege with User execution privileges needed. User interaction is needed for exploitation.</p></blockquote><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34720" target="_blank" rel="noopener">CVE-2024-34720</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/293e9ac230851acbec73f5ab12928d113d6283e1" target="_blank" rel="noopener">1</a><br>有新进程连接到 Zygote 时校验其 UID，确保是 system UID。原本 selinux policy 会限制只允许 system server 连接到 zygote 进程，但是对 app zygote 这个限制不够严格，两个 app zygote 进程可以相互连接然后发送伪造命令。<br>更多关于 app zygote 可以参考 <code>android:usesAppZygote</code> 和 <code>ZygotePreload</code> 的文档，我之前的检测 magisk 那篇文章也有简单提及。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34723" target="_blank" rel="noopener">CVE-2024-34723</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/c702bb71811993960debe0c18fcf8834cfa2454f" target="_blank" rel="noopener">1</a><br>MediaSession ParcelableListBinder 只允许塞入指定类型的对象，防止后台启动绕过。这个问题之后会单独写一篇文章讲解。</p><h3 id="System-5"><a href="#System-5" class="headerlink" title="System"></a>System</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31332" target="_blank" rel="noopener">CVE-2024-31332</a> EoP High <a href="https://android.googlesource.com/platform/packages/apps/Settings/+/d1f9e61e4480116838c7a642b54c217506361266" target="_blank" rel="noopener">1</a><br>如果当前用户被设置了 <code>DISALLOW_ADD_WIFI_CONFIG</code>，不显示 WifiDppConfiguratorActivity 和 AddNetworkFragment。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31339" target="_blank" rel="noopener">CVE-2024-31339</a> EoP High <a href="https://android.googlesource.com/platform/packages/modules/StatsD/+/795a0da721992432cae20fc9be21bcbce318bf5a" target="_blank" rel="noopener">1</a><br>statsd 中，MultiConditionTrigger 可能会开启一个新线程 executorThread，该线程会持有外部资源引用，应该在 MultiConditionTrigger 被销毁时 join 这个线程保证它执行完毕。应该是 race condition 导致 UAF 的问题。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34722" target="_blank" rel="noopener">CVE-2024-34722</a> EoP High <a href="https://android.googlesource.com/platform/packages/modules/Bluetooth/+/456f705b9acc78d8184536baff3d21b0bc11c957" target="_blank" rel="noopener">1</a><br>蓝牙组件的问题，似乎是逻辑 bug。看不懂，告辞~</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Fix an authentication bypass bug in SMP</span><br><span class="line"></span><br><span class="line">When pairing with BLE legacy pairing initiated</span><br><span class="line">from remote, authentication can be bypassed.</span><br><span class="line">This change fixes it.</span><br></pre></td></tr></table></figure><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34721" target="_blank" rel="noopener">CVE-2024-34721</a> ID High <a href="https://android.googlesource.com/platform/packages/providers/MediaProvider/+/7a1cbf5a8e17e6bff7c835fdd30dcc42b681db0a" target="_blank" rel="noopener">1</a><br>MediaProvider 中插入文件时，对文件路径没有被显式指定的情况缺乏检查，导致可以插入到其他用户的储存。听起来挺有意思的，后续可以复现玩玩。</p><h2 id="2024-06-01"><a href="#2024-06-01" class="headerlink" title="2024-06-01"></a>2024-06-01</h2><p>这个月竟然一个 critical 都没有，奇迹啊</p><h3 id="Framework-6"><a href="#Framework-6" class="headerlink" title="Framework"></a>Framework</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-21266" target="_blank" rel="noopener">CVE-2023-21266</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/5f446d2ce101e9072a46603d4e1ab66a336e35fa" target="_blank" rel="noopener">1</a><br>禁止第三方应用通过 killBackgroundProcesses() 杀死其他应用的进程。看 CVE 描述是能一直杀 play 保护服务的进程从而绕过 play 保护。去年 10 月就放过一遍了，不知道为什么又放了一遍。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31310" target="_blank" rel="noopener">CVE-2024-31310</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/74afbb05ca08738f66d82df867bbee66de4884bc" target="_blank" rel="noopener">1</a><br>强制自动填充服务必须声明对应的 intent-filter。<del>没有追详细调用链，猜测是为了防止 serviceComponent 被任意指定，调用到未导出的 service？</del><br>更新：漏洞描述指出了细节：用户选择它为自动填充 app -&gt; apk 更新，新的 apk 里这个服务缺失 intent-filter -&gt; 系统自动重绑定该服务 -&gt; 用户去设置里查看时，由于此时该 service 没有 intent-filter，该 app 不会被显示出来。</p><blockquote><p>Summary: App can continue to fill input fields in the device even if user has not selected it as default Autofill service app.<br>Details: In newServiceInfoLocked of AutofillManagerServiceImpl.java, there is a possible way to hide an enabled Autofill service app in the Autofill service settings due to improper input validation. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is needed for exploitation.</p></blockquote><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31316" target="_blank" rel="noopener">CVE-2024-31316</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/3457d82f8e265ad615b38f6a2aa3c33f1e100cb9" target="_blank" rel="noopener">1</a><br>AccountManagerService 在修改返回的 bundle （具体是三处 remove 敏感信息的地方）之后重新检查 bundle 内的 intent 是否合法。简单想了一下，没想到 lazy bundle 加持下能怎么利用，猜测是在非 lazy bundle 的场景下，按照 mismatch 对象、被移除的键值对、恶意 intent 这个顺序放置来绕过 <code>checkKeyIntentParceledCorrectly</code>？</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31317" target="_blank" rel="noopener">CVE-2024-31317</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/e25a0e394bbfd6143a557e1019bb7ad992d11985" target="_blank" rel="noopener">1</a><br>如果设置的 hidden api exemptions 含有非法字符，不把它传递给 zygote，防止干扰参数解析。此漏洞可被用于伪造 uid 等参数，在任意 app 上下文中执行任意代码。<br><a href="https://rtx.meta.security/exploitation/2024/06/03/Android-Zygote-injection.html" target="_blank" rel="noopener">https://rtx.meta.security/exploitation/2024/06/03/Android-Zygote-injection.html</a></p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31318" target="_blank" rel="noopener">CVE-2024-31318</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/b68b257d56a8600d53b4d2d06fb82aa44086a4a5" target="_blank" rel="noopener">1</a><br>此漏洞由我发现并报告。<br>CompanionDeviceManagerService onShellCommand() 内没有检查调用者权限，然后直接调用了同样没有权限检查的内部接口，造成越权访问，并直接造成权限提升。修复为把 <code>onShellCommand()</code> 改成重写 <code>handleShellCommand()</code>，因为 <code>Binder.onShellCommand()</code> 会先检查调用者 uid 确保必须是 root/shell。<br>关于这个漏洞的一点点番外：<br>通过分析提交历史，我发现这个函数以前其实是有一个权限检查的，但是在 Android 14 的一个提交 <a href="https://cs.android.com/android/_/android/platform/frameworks/base/+/7a8f22792e45630bff14eb8b276c7649b0d79097" target="_blank" rel="noopener">https://cs.android.com/android/_/android/platform/frameworks/base/+/7a8f22792e45630bff14eb8b276c7649b0d79097</a> 里被人删掉了。所以这其实是一个只影响 Android 14 的漏洞（这下新版本魔人大失败了）。<br>由于我不是 Google 员工，没法直接知道这个人这么做的原因，我这里只能猜测一下：可能是眼花了把这里看成已经在用 handleShellCommand 了，可能是觉得权限检查重复（Android 12 的时候这块代码在 ShellCmd 构造函数里），或者干脆就是 git 出了 bug 把这行给意外移除了，类似那个 gotofail 漏洞。<br>继续追踪提交历史，我发现了一个更搞笑的：2020 年，同样的系统服务，同样的 onShellCommand，曾经出现过一个一模一样的漏洞 CVE-2020-0227 <a href="https://android.googlesource.com/platform/frameworks/base/+/84cccfe6cdbc57ee372ee1a0fea64c7a11c53766^!/#F1" target="_blank" rel="noopener">https://android.googlesource.com/platform/frameworks/base/+/84cccfe6cdbc57ee372ee1a0fea64c7a11c53766^!/#F1</a> 。<br>嗯，让你不写回归测试，白给赏金了这下。</p><p>时间线：</p><ul><li>2023.10.4 Android 14 正式发布</li><li>2023.11.25 我注意到此漏洞</li><li>2023.11.26 构建了 PoC 并向 Android 安全团队反馈</li><li>2024.2.10 Google 确认此漏洞并将严重程度评级为高。对，你没看错，两个半月</li><li>2024.5.21 Google 通知我补丁将在下个月发布，并分配 CVE-2024-31318</li><li>2024.6.3 已经过去了 190 天，补丁终于发布</li></ul><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31319" target="_blank" rel="noopener">CVE-2024-31319</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/3cc021bf608fa813a9a40932028fdde2b12a2d5e" target="_blank" rel="noopener">1</a><br>NotificationListenerService 修改 notification channel 的 sound 时，校验它是否有权限访问这个 uri。<br>（漏洞类型不应该给 ID 吗，为啥给了个 EoP？）</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31322" target="_blank" rel="noopener">CVE-2024-31322</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/c1bc907a649addd5b97d489fd39afb956164a46c" target="_blank" rel="noopener">1</a><br>对于被卸载的应用，把其提供的 AccessibilityService 从已启用的服务列表里面移除。我记得这个问题以前好像处理过一次，向上追了一下，只有在 <code>onUserStateChangedLocked()</code> 有机会调用到这里，猜测此漏洞是在管理员用户卸载其他用户的应用而对应用户处于非活跃状态的时候触发？</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31324" target="_blank" rel="noopener">CVE-2024-31324</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/f16cc1135b414906164eb8fc55a76971b0e36c21" target="_blank" rel="noopener">1</a><br>如果窗口没有隐藏动画，需要立即隐藏它。说实话，没怎么看懂，看 CVE 描述是通过以竖屏模式启动 activity 然后旋转到横屏模式可以绕过点按劫持保护，似乎是逻辑漏洞。留给有缘人分析复现吧~~</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Hide window immediately if itself doesn&#39;t run hide animation</span><br><span class="line"></span><br><span class="line">The condition was overextended in commit 9bca6b4 which checks if the</span><br><span class="line">parent container of the window is animating. That causes the window to</span><br><span class="line">wait for animation finish to update visibility, but the animation</span><br><span class="line">finish callback won&#39;t happen because itself is not animating. Then the</span><br><span class="line">window that should be hidden remains on screen.</span><br><span class="line"></span><br><span class="line">Bug: 302431573</span><br><span class="line">Test: atest WindowStateTests#testIsOnScreen_hiddenByPolicy</span><br></pre></td></tr></table></figure><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31325" target="_blank" rel="noopener">CVE-2024-31325</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/9fcd2070f22c0c6b30ecdc914cef83b5891d5f68" target="_blank" rel="noopener">1</a><br>SystemUI 解析 notification message/conversation 相关的图片 uri 时需要使用对应用户的 context。不确定在什么时候能触发。<br>（看起来漏洞类型应该给 ID 才对？还有为什么放 framework 里而不是 system？）</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31326" target="_blank" rel="noopener">CVE-2024-31326</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/736462a777d0a0e1258bd7ab80d6e352ef797669%5E%21/#F0" target="_blank" rel="noopener">1</a> <a href="https://android.googlesource.com/platform/frameworks/base/+/f1eb8e719dfbe15a38d40af0a73ead207eba9389" target="_blank" rel="noopener">2</a><br>Android 14 设备管理相关的配置存储方式发生变化，而又没有正确迁移相关配置，导致设备从旧版本更新到 14 之后设备管理员做出的限制丢失。具体来说是截图策略（screen capture policy）、lock task 配置、user restrictions 这三个。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31312" target="_blank" rel="noopener">CVE-2024-31312</a> ID High <a href="https://android.googlesource.com/platform/frameworks/base/+/748055291460bcaafa3e53c7da1601a687959477" target="_blank" rel="noopener">1</a><br>如果设置锁屏隐藏通知，隐藏 media carousel（媒体操作面板？）。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31314" target="_blank" rel="noopener">CVE-2024-31314</a> DoS High <a href="https://android.googlesource.com/platform/frameworks/base/+/c0d5f75e01308fb7d6d86639a0a6e2ff81b30be6" target="_blank" rel="noopener">1</a><br>ShortcutService 可能会调用 <code>UsageStatsManager.reportShortcutUsage()</code>，对调用频率添加限制，防止拒绝服务。</p><h3 id="System-6"><a href="#System-6" class="headerlink" title="System"></a>System</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-21113" target="_blank" rel="noopener">CVE-2023-21113</a> EoP High <a href="https://android.googlesource.com/platform/build/soong/+/e7b7f0833dc47ade981eddfbf462dcc143dddd10" target="_blank" rel="noopener">1</a> <a href="https://android.googlesource.com/platform/frameworks/base/+/17dd11248a66b2722aa3ef07701b7f09a64160e5" target="_blank" rel="noopener">2</a> <a href="https://android.googlesource.com/platform/prebuilts/module_sdk/Wifi/+/c705bae1a4d50bd7b4f8cc919097d1aae568dd22" target="_blank" rel="noopener">3</a><br>如果 AttributionSource 反序列化不是因为 binder 调用被触发，清空所有权限状态。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-21114" target="_blank" rel="noopener">CVE-2023-21114</a> EoP High <a href="https://android.googlesource.com/platform/packages/modules/Wifi/+/f88a2294f53cf382908cc48f992273742f817dd5" target="_blank" rel="noopener">1</a> <a href="https://android.googlesource.com/platform/packages/modules/Wifi/+/e6ca0c031758d8b1511f6a359bec316b6d2e22fe" target="_blank" rel="noopener">2</a> <a href="https://android.googlesource.com/platform/packages/modules/Wifi/+/f39ed052916716ef974102b3bad7ae102d0164a5" target="_blank" rel="noopener">3</a><br>WiFi 模块中先把 AttributionSource 从 bundle 提取出来再把任务交给工作线程处理。由于 android 13 引入的 lazy bundle 优化，对于 parcelable 类型只有在被实际访问的时候才会触发反序列化，而原来的代码中 bundle 里的 AttributionSource 在工作线程而非 binder 线程中被访问，触发反序列化时 <code>Binder.getCallingUid()</code> 等方法返回的是 system server 自己的信息，造成权限绕过。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31311" target="_blank" rel="noopener">CVE-2024-31311</a> EoP High <a href="https://android.googlesource.com/platform/packages/modules/StatsD/+/b6aab6c000ab85f4e4d8bb3941bcc33800550374" target="_blank" rel="noopener">1</a><br>libstatssocket 内检查 AStatsEvent 的 lastFieldPos 必须小于 bufSize。</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> // Side-effect: modifies event-&gt;errors if field has too many annotations</span><br><span class="line"> static void increment_annotation_count(AStatsEvent* event) &#123;</span><br><span class="line"><span class="addition">+    if (event-&gt;lastFieldPos &gt;= event-&gt;bufSize) &#123;</span></span><br><span class="line"><span class="addition">+        return;</span></span><br><span class="line"><span class="addition">+    &#125;</span></span><br><span class="line">     uint8_t fieldType = event-&gt;buf[event-&gt;lastFieldPos] &amp; 0x0F;</span><br><span class="line">     uint32_t oldAnnotationCount = (event-&gt;buf[event-&gt;lastFieldPos] &amp; 0xF0) &gt;&gt; 4;</span><br><span class="line">     uint32_t newAnnotationCount = oldAnnotationCount + 1;</span><br></pre></td></tr></table></figure><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31313" target="_blank" rel="noopener">CVE-2024-31313</a> EoP High <a href="https://android.googlesource.com/platform/system/libfmq/+/79bbf4aeef4b254c52da670a972e22956c8c659d" target="_blank" rel="noopener">1</a><br>消息队列里检查越界情况。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31315" target="_blank" rel="noopener">CVE-2024-31315</a> EoP High <a href="https://android.googlesource.com/platform/frameworks/base/+/a9ee2793068235ff423d08cc0964870c054d1983" target="_blank" rel="noopener">1</a><br>NotificationListenerService rebind 及所属包更新的时候，如果此时该服务不再被权限保护（没有声明 <code>android:permission</code>），不要 bind 它。<br><del>（这也算漏洞？CVE 描述又看不了，不清楚有没有其他触发场景）</del><br>查看描述后发现和上面的 CVE-2024-31310 是类似的：用户打开权限 -&gt; apk 更新，新的 apk 里这个服务不再被 permission 保护 -&gt; 系统自动重绑定该服务 -&gt; 用户去设置里查看时，由于此时该 service <code>android:permission</code> 配置不对，该 app 不会被显示出来。</p><blockquote><p>Summary: App can read all notifications of the device without requiring any permission.<br>Details: In multiple functions of ManagedServices.java, there is a possible way to hide an app with notification access in the Device &amp; app notifications settings due to improper input validation. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is needed for exploitation.</p></blockquote><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31323" target="_blank" rel="noopener">CVE-2024-31323</a> EoP High <a href="https://android.googlesource.com/platform/packages/modules/HealthFitness/+/c4e13d15e8dd1df1bd827117d1a74c187ed2b3c2" target="_blank" rel="noopener">1</a><br>悬浮窗覆盖漏洞限时返场，这次是 Health Connect 这个 app 里。只影响 14。</p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31327" target="_blank" rel="noopener">CVE-2024-31327</a> EoP High <a href="https://android.googlesource.com/platform/system/libfmq/+/79bbf4aeef4b254c52da670a972e22956c8c659d" target="_blank" rel="noopener">1</a><br>补丁链接和 CVE-2024-31313 是一样的。</p><h2 id="2024-06-05"><a href="#2024-06-05" class="headerlink" title="2024-06-05"></a>2024-06-05</h2><h3 id="Kernel"><a href="#Kernel" class="headerlink" title="Kernel"></a>Kernel</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-26926" target="_blank" rel="noopener">CVE-2024-26926</a> EoP High <a href="https://android.googlesource.com/kernel/common/+/bf4f9bc41c3b5203e1e7284e1de78e82f0630473" target="_blank" rel="noopener">1</a> <a href="https://android.googlesource.com/kernel/common/+/7a2aa337ab8235460c1efa92a846eaeade5f2514" target="_blank" rel="noopener">2</a><br>内核 binder 驱动里 <code>binder_get_object()</code> 检查 offset 必须按 4 字节对齐。</p><h2 id="2024-05-01"><a href="#2024-05-01" class="headerlink" title="2024-05-01"></a>2024-05-01</h2><h3 id="Framework-7"><a href="#Framework-7" class="headerlink" title="Framework"></a>Framework</h3><p>CVE-2024-0024 EoP High<br>创建用户时限制将用户名、账号名、账号类型这三个字符串的长度，否则长度可能会超出 BinaryXmlSerializer 的写入限制，导致后续 user restrictions 写入失败，创建出没有限制的用户。<br>疑问：我在今年1月4号就已经在 aosp 上看见了这个提交，为什么现在才放在安全公告里？</p><p>CVE-2024-0025 EoP High<br>发送非 PendingIntent 类型的 IntentSender 时避免携带 allowlist token。因为这个时候传入的 IIntentSender 实际上可能是 app 的一个 binder，再在上面调用 send 实际上相当于把 allowlist token 直接发送给了 app，然后这个 token 可以用来绕过很多的后台限制。<br>大概猜测一下利用方法：<br>创建一个自定义 IIntentSender<br>把它塞进一个 PendingIntent 里（PendingIntent 存放着一个 IIntentSender，这是它的真正实现）<br>把 PendingIntent 放进 notification deleteIntent 里<br>发送 notification 然后立刻取消，触发 deleteIntent 执行<br>PendingIntent.send() 把内部的 IIntentSender 传递到 sendIntentSender，因为这个 IIntentSender 不是 PendingIntentRecord，所以 IIntentSender.send() 被调用，此时会直接把 allowlist token 发给 app<br>妙啊，太妙了<br>疑问：1月4号我也看见了这个补丁，为什么现在才发出来？</p><p>CVE-2024-23705 EoP High<br>在 CVE-2024-0024 补丁的基础上限制 accountOptions 的大小，防止类似的问题。</p><p>CVE-2024-23708 EoP High<br>让系统发出的 toast 优先显示，保证其他应用不能通过发送大量 toast 的方式延后系统 toast 显示。同时把粘贴剪贴板文字的 toast 的显示时长加到 long。</p><h3 id="System-7"><a href="#System-7" class="headerlink" title="System"></a>System</h3><p>（跳过 CVE-2024-23709）</p><p>CVE-2024-23706 EoP Critical<br>android health 相关的功能，禁止插入 record types 为空的 changelog。对这模块不是很熟，没看懂能干啥，也没看懂为啥定级这么高，待进一步分析。CVE 描述：In multiple locations, there is a possible bypass of health data permissions due to an improper input validation. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is not needed for exploitation.</p><p>CVE-2024-0043 EoP High<br>在 PermissionController 后端禁止给 work profile 中的应用授权监听通知。<br>更新：据反馈，此漏洞触发方式是通过 companion device watch role 自动授予相关权限。<br>注：官方公告里放的补丁链接似乎是错的，正确的应该是 <a href="https://cs.android.com/android/_/android/platform/packages/modules/Permission/+/47a06cd49981d3fbe58158e9252f0a825aa109cd" target="_blank" rel="noopener">https://cs.android.com/android/_/android/platform/packages/modules/Permission/+/47a06cd49981d3fbe58158e9252f0a825aa109cd</a></p><p>CVE-2024-23707 EoP High<br>系统设置里 SearchResultTrampoline 把原来的用 getCallingActivity 判断调用者改成用 getLaunchedFromPackage，前者返回的是哪个 activity 会收到 onActivityResult 回调，后者返回的是实际启动 Activity 的人（Pending intent 按创建者算）</p><h2 id="2024-04-01"><a href="#2024-04-01" class="headerlink" title="2024-04-01"></a>2024-04-01</h2><p>这次补丁给我的感觉就是，像愚人节特辑</p><h3 id="Framework-8"><a href="#Framework-8" class="headerlink" title="Framework"></a>Framework</h3><p>CVE-2024-23710 EoP High<br>如果一个 app 和特权 app 共享 UID，并且设置了 sharedUserMaxSdkVersion 且处于生效状态，那么 sharedUserId 的设置是无效的，这个时候不应该把它标记为特权 app</p><p>CVE-2024-23713 EoP High<br>NotificationManagerService migrateNotificationFilter 内如果传入的 disallowApps 并没有被安装就跳过它。猜测问题是可以传入超长字符串阻止 mRequestedNotificationListeners 被序列化，从而阻止数据变更被保存？</p><p>CVE-2024-0022 ID High<br>CompanionDeviceManagerService requestNotificationAccess 没有检查传入的 user id，而是留了个 TODO 在那里（写到一半想着先这样完事然后就忘了？），然后直接用这个 user id 取得一个 PendingIntent 并返回，然后发送这个 pending intent 实际上可以跳到对应用户的通知访问管理页面。这个问题我很早就注意到了，但是反馈被标 duplicate 了。</p><p>CVE-2024-23712 DoS High<br>AppOpsService 里过滤未被定义的 proxyAttributionTag （这啥？），同时把一个包里最大能定义的<attribution>标签的数量从 10000 下调到 1000，防止大量数据造成 DoS。有待进一步分析。</attribution></p><h3 id="System-8"><a href="#System-8" class="headerlink" title="System"></a>System</h3><p>CVE-2024-23704 EoP High<br>如果当前用户有 DISALLOW_ADD_WIFI_CONFIG 这个限制，不允许打开 WifiDialogActivity。</p><p>CVE-2023-21267 ID High<br>去年12月的补丁，原问题是有 app pining 的时候尝试按电源键 lockdown 会因为逻辑错误跳过锁屏。原来的补丁有问题，回滚了之后修复了问题重新提交。</p><p>CVE-2024-0026/CVE-2024-0027 DoS High<br>大量 snoozed notifications 可能导致的拒绝服务问题（这个问题不是修过几次吗怎么又来了？）。判断 snooze notification 数量是否超限的时候要把已经存进文件里的（mPersistedSnoozedNotifications 和 mPersistedSnoozedNotificationsWithContext）一并纳入计算。还修复了 repostGroupSummary 方法里没有把通知从 mPersistedSnoozedNotifications 和 mPersistedSnoozedNotificationsWithContext 里移除的问题，会导致不需要的通知数据始终被序列化，可能被滥用导致资源耗尽拒绝服务。</p><h2 id="2024-03-01"><a href="#2024-03-01" class="headerlink" title="2024-03-01"></a>2024-03-01</h2><h3 id="Framework-9"><a href="#Framework-9" class="headerlink" title="Framework"></a>Framework</h3><p>（跳过了 CVE-2024-0049/CVE-2024-0050/CVE-2024-0051，三个都是 libstagefright 中的内存错误）</p><p>CVE-2024-0044 EoP High<br>过滤应用的“安装者包名”（可以通过 pm install -i 指定）里的非法字符。此漏洞细节：攻击者可以在“安装者包名”内插入换行符，之后系统会把该字段原样写进 /data/system/packages.list 里，伪造出新的条目，之后可以通过伪造的条目欺骗 run-as 从而获得受害应用的权限，可以操作内部目录等。<br>发现者的博客写的很清楚了：<a href="https://rtx.meta.security/exploitation/2024/03/04/Android-run-as-forgery.html" target="_blank" rel="noopener">https://rtx.meta.security/exploitation/2024/03/04/Android-run-as-forgery.html</a><br><del>数据取证专用漏洞了属于是</del></p><p>CVE-2024-0046 EoP High<br>阻止系统应用被升级为 instant app（免安装应用 <del>谷歌小程序</del>）。免安装应用只能获得很小的一部分权限，攻击者可以利用该漏洞使特定系统应用的权限失效，从而绕过运营商限制。</p><p>CVE-2024-0048 EoP High<br>AccountManagerService 又上新补丁了。AccountManagerService 内部有一个超时机制，bind 到 Authenticator 后如果它长时间没响应就 unbind。搞笑的是，代码里根本没有任何地方启动这个机制，整个超时机制根本不会被触发。AccountManager API 最初在 Android 2.1 里加入，十几年过去了还能有这种问题，提前预定一个 2024 年最搞笑漏洞。</p><p>CVE-2024-0053 ID High<br>如果打印服务返回的自定义的打印机图标里的 URI 指向其他用户就把它过滤掉，防止看见其他用户的图像。最近这种漏洞真的好多好多。</p><p>CVE-2024-0047 DoS High<br>Android 14 中对设备管理（Android for Work 的功能）的重构中引入的 bug，设备管理员设置的 global restriction（对整个设备的限制）可能会被错误识别为 local restriction（对单个用户的限制），导致管理员无法撤销限制，设备功能受限。就算 bug 修好了，已经损坏的配置文件仍然是损坏的，为了让这些设备不清除数据就能正常工作还要加个 workaround。</p><h3 id="System-9"><a href="#System-9" class="headerlink" title="System"></a>System</h3><p>（跳过了 CVE-2024-0039、CVE-2024-23717、CVE-2024-0045）</p><p>CVE-2023-40081 ID High<br>SystemUI 加载多媒体文件的图标时检查 URI 权限，防止跨用户读取</p><p>CVE-2024-0052 ID High<br>对 Android Health 这个功能不是很熟，看提交信息是如果调用者没有权限，部分 API 返回的数据要去除掉用户运动的路线信息。</p><h2 id="2024-02-01"><a href="#2024-02-01" class="headerlink" title="2024-02-01"></a>2024-02-01</h2><h3 id="Framework-10"><a href="#Framework-10" class="headerlink" title="Framework"></a>Framework</h3><p>CVE-2024-0029 EoP High<br>DevicePolicyManagerService 里的逻辑 bug，保存禁止截屏的状态的时候只用了一个 int 保存被禁用的用户 id，在未受管用户启动的时候会覆盖掉之前设置的。</p><p>CVE-2024-0032 EoP High<br>DownloadStorageProvider 正确重写带有 includeHidden 参数的 queryChildDocuments()。<br>更多可参考 <a href="https://t.me/qianqianzhuang/4" target="_blank" rel="noopener">https://t.me/qianqianzhuang/4</a></p><p>CVE-2024-0034 EoP High<br>阻止壁纸服务从后台启动 activity。因为前台客户端绑定壁纸服务之后，会满足这一条豁免条件 “该应用的一项服务被另一个可见的应用绑定。绑定到该服务的应用必须保持可见，以便后台应用成功启动 activity。”<br>安卓 14 的 BAL 强化中限制了 target&gt;=U 时必须指定 BIND_ALLOW_ACTIVITY_STARTS 才允许服务进程借用客户进程的状态启动，故该漏洞不影响 14</p><p>CVE-2024-0036 EoP High<br>startNextMatchingActivity 中设置 setAvoidMoveToFront 阻止后台启动 activity，具体可见 <a href="https://mp.weixin.qq.com/s/dbupJ3D-i0Da9ml1Pamu-w" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/dbupJ3D-i0Da9ml1Pamu-w</a><br>这个接口漏了这么久都没人注意到确实挺难得的，<del>当然我也没注意到，但是你看别人都没注意到，所以也不能怪我，你说是吧</del></p><p>CVE-2024-0038 EoP High<br>injectInputEventToInputFilter 中缺失调用者权限检查，只影响 14</p><p>CVE-2024-0041 EoP High<br>removePersistentDot 里的竞态条件，有可能导致 persistent dot 不会移除（然后会覆盖新显示的状态？）</p><p>CVE-2023-40122 &amp; CVE-2024-0037 EoP High<br>检查自动填充相关传入的 URI，确保不会读取到其他用户的数据</p><p>CVE-2024-0040 ID High<br>MTP 协议处理中没有正确增大缓冲区大小，可能发生越界读</p><h3 id="System-10"><a href="#System-10" class="headerlink" title="System"></a>System</h3><p>CVE-2024-0031 RCE Critical<br>蓝牙 GATT 协议栈里的越界写，理论可实现 RCE。这玩意真的几乎每个月都能搞一个 RCE 出来。</p><p>CVE-2024-0014 EoP High<br>该漏洞未公开补丁链接，似乎是 GMS 私有组件。漏洞描述：In startInstall of UpdateFetcher.java, there is a possible way to trigger a malicious config update due to a logic error. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is not needed for exploitation.</p><p>CVE-2024-0033 EoP High<br>libbinder 打开 memfd 时指定 F_SEAL_GROW | F_SEAL_SHRINK 阻止后续其他进程更改大小造成错误</p><p>CVE-2024-0035 EoP High<br>TileService 返回 null 时正确释放资源，阻止绕过后台启动前台 activity 的限制。更多可以参考 <a href="https://wrlus.com/android-security/bindservice-error-handle/" target="_blank" rel="noopener">https://wrlus.com/android-security/bindservice-error-handle/</a></p><p>CVE-2023-40093 ID High<br>升级 pdfium 到 Chrome 114.0.5735.130 的</p><p>CVE-2024-0030 ID High<br>蓝牙组件里不充分的检查可能造成越界读</p><h2 id="2024-01-01"><a href="#2024-01-01" class="headerlink" title="2024-01-01"></a>2024-01-01</h2><h3 id="Framework-11"><a href="#Framework-11" class="headerlink" title="Framework"></a>Framework</h3><p>CVE-2023-21245 EoP High<br>阻止在设备设置向导完成之前进入锁屏，可以插入一张需要 PIN/PUK 码解锁的 SIM 卡复现。应该是可以绕过恢复出厂保护（FRP，Factory Reset Protection），也就是所谓的激活锁。</p><p>CVE-2024-0015 EoP High<br>保证 DreamService 配置的 settingsActivity 属于应用自身，防止调用到非公开的 activity 造成 launch anywhere。向上搜索可以发现 SettingsLib 的 DreamBackend launchSettings() 这个方法会直接 startActivity，这里在 Settings 里运行所以是 system 权限。<br>题外话：DreamService 是 Android 4.2 加入的，十几年过去了，相关代码在2024年1月还能出现这么简单直接的漏洞确实有点不可思议。这个补丁早在2022年就创建了，而且更新的版本列表里并没有最新的14，于是我去看了下14的代码发现确实已经合进了这个补丁，然后我搜索这个补丁，发现这个漏洞早在2022年就被确认并被授予 CVE-2022-20550 这个编号，但是谷歌当时不知道怎么想的只给了 moderate 评级然后只给 pixel 修了。。。</p><p>CVE-2024-0018 EoP High<br>libstagefright 里无符号数运算不当导致意外结果的漏洞。</p><p>CVE-2024-0019 ID High<br>System UI 进程重启后，如果在重启之前有应用在进行敏感操作，并且现在还没结束，那么仍然应该显示隐私指示器。</p><h3 id="System-11"><a href="#System-11" class="headerlink" title="System"></a>System</h3><p>CVE-2024-0021 EoP High<br>禁止工作空间（work profile）内的应用监听通知，只给 13 14 更新了，应该是以前正常的功能，大版本迭代不小心引入。</p><p>CVE-2024-0017 ID High<br>Camera2 如果是被其他 app 启动，而且启动它的这个 app 没有位置权限，返回的照片 exif 信息里不应该包含位置信息。之前的代码里有做判断，但是有问题，getCallingPackage 返回 null 的时候一律判定为不是 app 启动不需要过滤，但是如果 app 用 startActivity 而非 startActivityForResult ，getCallingPackage 本来就会返回 null，算是逻辑 bug。</p><p>CVE-2024-0020 ID High<br>设置铃声的时候检查传入的 URI，防止指向别的用户的数据。最近这种问题似乎很多很多。</p><h2 id="2023-12-01"><a href="#2023-12-01" class="headerlink" title="2023-12-01"></a>2023-12-01</h2><p>可能在野被积极利用的漏洞：CVE-2023-33063、CVE-2023-33107、CVE-2023-33106</p><h3 id="Framework-12"><a href="#Framework-12" class="headerlink" title="Framework"></a>Framework</h3><p>CVE-2023-40077 EoP Critical<br>libstagefright 里的 UAF 问题</p><p>CVE-2023-40076 ID Critical<br>CredentialManagerUi 跑在 system_server，且创建 PendingIntent 的时候没有指定用户，默认会去用 context 对应的用户，然后指向 USER 0，其他用户拿到这个 PendingIntent 然后 send 就能跳转到主用户的凭据管理页面。不知道为什么定级这么高</p><p>CVE-2023-40079 EoP High<br>ShortcutService 启动 app 给出的 IntentSender 时指定 MODE_BACKGROUND_ACTIVITY_START_DENIED 防止 BAL</p><p>CVE-2023-40089 EoP High<br>DevicePolicyService.getCredentialManagerPolicy 需要传入 userId。感觉这个漏洞的实际影响情况可能是有跨用户权限的进程需要拿到其他用户的东西但是因为之前的设计问题所以拿不到？</p><p>CVE-2023-40094 EoP High<br>keyguardGoingAway 这个方法没检查调用者权限，然后所有 app 都能调用这个方法解除锁屏。</p><p>CVE-2023-40095 EoP High<br>又是一个忘了指定禁止 BAL 造成的 BAL bypass，这次是 requestGeofence 。</p><p>CVE-2023-40096 EoP High<br>更改的文件比较多，看起来是设置录音权限为仅前台时应用退到后台还会继续录音的问题。</p><p>CVE-2023-40103 EoP High<br>看提交信息是用 ApkAssets 的时候改成用基于引用计数的指针，防止 UAF/double free</p><p>CVE-2023-45774 EoP High<br>ShortcutService 校验传入的 uri。看 cve 描述是能指定其他用户的图像。</p><p>CVE-2023-45777 EoP High<br><del>最看不懂的一集<br>给了两个提交，第一个提交和九月份的 CVE-2023-35669 补丁是一样的，当时这个漏洞描述是 “there is a possible way to control other running activities”，第二个提交只是把弃用不带类型的 getParcelable 改成类型安全的，然而底下明明就有手动的类型检查，我觉得缺这个提交也没法利用，不知道为什么又分配了一个 CVE。看这个 CVE 的描述是能 Launch Anywhere ，不知道怎么能做到。</del></p><p>AccountManagerService 里使用不带参数类型的 <code>getParcelable()</code> 方法可能会导致反序列化出非预期的对象，调用到其他类的构造方法，导致 parcel 数据被修改，绕过 <code>checkKeyIntentParceledCorrectly</code> 的缓解措施。PoC： <a href="https://github.com/michalbednarski/TheLastBundleMismatch" target="_blank" rel="noopener">https://github.com/michalbednarski/TheLastBundleMismatch</a></p><p>CVE-2023-21267 ID High<br>在 lockdown 模式始终展示锁屏。看起来是有 app pinning 的时候尝试 lockdown 会因为逻辑错误跳过显示锁屏。</p><p>CVE-2023-40073 ID High<br>Notification style 相关的 uri 校验</p><p>CVE-2023-40081 ID High<br>MediaDataManager URI 校验。截止目前已经是第三个了。</p><p>CVE-2023-40092 ID High<br>ShortcutService 多个函数检查 user id，防止跨用户操作</p><p>CVE-2023-40074 DoS High<br>PersistableBundle 忽略无效数据，防止拒绝服务。</p><p>CVE-2023-40075 DoS High<br>限制能通过 addDynamicShortcuts 添加的快捷方式的数量。</p><h3 id="System-12"><a href="#System-12" class="headerlink" title="System"></a>System</h3><p>这里面大部分洞都是比较传统的内存损坏，所以跳过了很多漏洞。</p><p>CVE-2023-40088 RCE Critical<br>蓝牙相关，com_android_bluetooth_btservice_AdapterService free callbackEnv 这个指针后没有置空，可能发生 UAF。不知道是不是我的错觉，总感觉近几个月能 RCE 的漏洞好像变多了。</p><p>CVE-2023-40097 EoP High<br>禁止创建目标为 Chooser 的快捷方式。没看懂有什么意义，看 CVE 描述是 URI grant。</p><p>CVE-2023-21394 ID High<br>添加 phone account 时检查给定的 URI，防止跨用户读取图片。嗯，第四个了。</p><p>CVE-2023-35668 ID High<br>又是 URI 相关的跨用户读取，这次还是 Notification 里……</p><p>CVE-2023-40098 ID High<br>看起来是有个叫 priority conversation widget 的东西，其他用户添加这个 widget 能看见主用户的通知。解决方法就是不让其他用户添加。</p><br><section class="widget copyright desktop mobile"><div class="content"><blockquote><p>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</p><p>本文永久链接是：<a href="https://blog.canyie.top/2024/04/18/android-security-bulletin-index/">https://blog.canyie.top/2024/04/18/android-security-bulletin-index/</a></p></blockquote></div></section></div><section class="meta" id="footer-meta"><div class="new-meta-box"><div class="new-meta-item date" itemprop="dateUpdated" datetime="2025-04-24T18:33:02+08:00"><a class="notlink"><i class="fas fa-edit fa-fw" aria-hidden="true"></i><p>更新于2025年4月24日</p></a></div><div class="new-meta-item meta-tags"><a class="tag" href="/tags/android/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>android</p></a></div><div class="new-meta-item meta-tags"><a class="tag" href="/tags/system/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>system</p></a></div><div class="new-meta-item meta-tags"><a class="tag" href="/tags/%E5%AE%89%E5%85%A8/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>安全</p></a></div><div class="new-meta-item meta-tags"><a class="tag" href="/tags/%E5%AE%89%E5%85%A8%E8%A1%A5%E4%B8%81%E5%88%86%E6%9E%90%E6%A0%8F%E7%9B%AE/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>安全补丁分析栏目</p></a></div><div class="new-meta-item share -mob-share-list"><div class="-mob-share-list share-body"><a class="-mob-share-qq" rel="external nofollow noopener noreferrer noopener" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.canyie.top/2024/04/18/android-security-bulletin-index/&title=Android 2024 每月安全补丁分析索引 - 残页的小博客&summary=之前一直在看的每月补丁分析的博客 https://wrlus.com/ 看起来是不再更新了，想了想反正自己每个月也要去追着看，干脆写一下分析得了，方便自己后面找。本人很菜，分析的大部分都是 Java 层漏洞，大佬别骂我 QAQ最初发表在我的 telegram 频道。每月补丁都会在此文中更新。2025 年度补丁分析：点我最后更新时间：2025/01/29 更新内容：添加 2025 年度链接" target="_blank"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qq.png"> </a><a class="-mob-share-qzone" rel="external nofollow noopener noreferrer noopener" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://blog.canyie.top/2024/04/18/android-security-bulletin-index/&title=Android 2024 每月安全补丁分析索引 - 残页的小博客&summary=之前一直在看的每月补丁分析的博客 https://wrlus.com/ 看起来是不再更新了，想了想反正自己每个月也要去追着看，干脆写一下分析得了，方便自己后面找。本人很菜，分析的大部分都是 Java 层漏洞，大佬别骂我 QAQ最初发表在我的 telegram 频道。每月补丁都会在此文中更新。2025 年度补丁分析：点我最后更新时间：2025/01/29 更新内容：添加 2025 年度链接" target="_blank"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qzone.png"> </a><a class="-mob-share-weibo" rel="external nofollow noopener noreferrer noopener" href="http://service.weibo.com/share/share.php?url=https://blog.canyie.top/2024/04/18/android-security-bulletin-index/&title=Android 2024 每月安全补丁分析索引 - 残页的小博客&summary=之前一直在看的每月补丁分析的博客 https://wrlus.com/ 看起来是不再更新了，想了想反正自己每个月也要去追着看，干脆写一下分析得了，方便自己后面找。本人很菜，分析的大部分都是 Java 层漏洞，大佬别骂我 QAQ最初发表在我的 telegram 频道。每月补丁都会在此文中更新。2025 年度补丁分析：点我最后更新时间：2025/01/29 更新内容：添加 2025 年度链接" target="_blank"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/weibo.png"></a></div></div></div></section><div class="prev-next"><a class="prev" href="/2024/08/24/CVE-2024-48336/"><p class="title"><i class="fas fa-chevron-left" aria-hidden="true"></i>MagiskEoP (CVE-2024-48336)： Magisk App Arbitrary Code Execution Vulnerability</p><p class="content">Magisk App before Canary version 27007 contains a vulnerability CVE-2024-48336, which allows a lo...</p></a><a class="next" href="/2023/11/12/android-booting-shenanigans-and-magiskinit-analysing/"><p class="title">在故事开始之前的故事：Android 启动过程与 magiskinit 分析<i class="fas fa-chevron-right" aria-hidden="true"></i></p><p class="content">终于开了一直想写的这篇文章，再不写点东西就真的是年更博客了……本文可以认为是 Android Booting Shenanigans 的中文补充说明，同时添加了 magiskinit 的一些处理...</p></a></div></section></article><script>window.subData={title:"Android 2024 每月安全补丁分析索引",tools:!0}</script></div><aside class="l_side"><section class="widget toc-wrapper shadow blur desktop mobile"><header><i class="fas fa-list fa-fw" aria-hidden="true"></i><span class="name">本文目录</span></header><div class="content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-12-01"><span class="toc-text">2024-12-01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework"><span class="toc-text">Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#System"><span class="toc-text">System</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-11-01"><span class="toc-text">2024-11-01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework-1"><span class="toc-text">Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#System-1"><span class="toc-text">System</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-10-01"><span class="toc-text">2024-10-01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework-2"><span class="toc-text">Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#System-2"><span class="toc-text">System</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-09-01"><span class="toc-text">2024-09-01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework-3"><span class="toc-text">Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#System-3"><span class="toc-text">System</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-08-01"><span class="toc-text">2024-08-01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework-4"><span class="toc-text">Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#System-4"><span class="toc-text">System</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-07-01"><span class="toc-text">2024-07-01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework-5"><span class="toc-text">Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#System-5"><span class="toc-text">System</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-06-01"><span class="toc-text">2024-06-01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework-6"><span class="toc-text">Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#System-6"><span class="toc-text">System</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-06-05"><span class="toc-text">2024-06-05</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Kernel"><span class="toc-text">Kernel</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-05-01"><span class="toc-text">2024-05-01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework-7"><span class="toc-text">Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#System-7"><span class="toc-text">System</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-04-01"><span class="toc-text">2024-04-01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework-8"><span class="toc-text">Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#System-8"><span class="toc-text">System</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-03-01"><span class="toc-text">2024-03-01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework-9"><span class="toc-text">Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#System-9"><span class="toc-text">System</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-02-01"><span class="toc-text">2024-02-01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework-10"><span class="toc-text">Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#System-10"><span class="toc-text">System</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-01-01"><span class="toc-text">2024-01-01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework-11"><span class="toc-text">Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#System-11"><span class="toc-text">System</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2023-12-01"><span class="toc-text">2023-12-01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Framework-12"><span class="toc-text">Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#System-12"><span class="toc-text">System</span></a></li></ol></li></ol></div></section><section class="widget tagcloud shadow blur desktop mobile"><header><a href="/tags/"><i class="fas fa-tags fa-fw" aria-hidden="true"></i><span class="name">热门标签</span></a></header><div class="content"><a href="/tags/AOP/" style="font-size:15.67px;color:#8e8e8e">AOP</a> <a href="/tags/android/" style="font-size:24px;color:#555">android</a> <a href="/tags/art/" style="font-size:19px;color:#777">art</a> <a href="/tags/dex/" style="font-size:14px;color:#999">dex</a> <a href="/tags/hidden-api/" style="font-size:14px;color:#999">hidden-api</a> <a href="/tags/hook/" style="font-size:15.67px;color:#8e8e8e">hook</a> <a href="/tags/kernel/" style="font-size:15.67px;color:#8e8e8e">kernel</a> <a href="/tags/magisk/" style="font-size:17.33px;color:#828282">magisk</a> <a href="/tags/parcel/" style="font-size:14px;color:#999">parcel</a> <a href="/tags/property/" style="font-size:14px;color:#999">property</a> <a href="/tags/system/" style="font-size:22.33px;color:#606060">system</a> <a href="/tags/xposed/" style="font-size:17.33px;color:#828282">xposed</a> <a href="/tags/%E5%AE%89%E5%85%A8/" style="font-size:20.67px;color:#6c6c6c">安全</a> <a href="/tags/%E5%AE%89%E5%85%A8%E8%A1%A5%E4%B8%81%E5%88%86%E6%9E%90%E6%A0%8F%E7%9B%AE/" style="font-size:15.67px;color:#8e8e8e">安全补丁分析栏目</a> <a href="/tags/%E5%B9%B4%E9%89%B4/" style="font-size:15.67px;color:#8e8e8e">年鉴</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" style="font-size:14px;color:#999">数据结构与算法</a> <a href="/tags/%E6%B3%A8%E5%85%A5/" style="font-size:15.67px;color:#8e8e8e">注入</a> <a href="/tags/%E8%88%AA%E7%A9%BA/" style="font-size:14px;color:#999">航空</a> <a href="/tags/%E9%97%B2%E8%81%8A/" style="font-size:17.33px;color:#828282">闲聊</a></div></section></aside><footer class="clearfix"><br><br><br><div class="social-wrapper"><a href="/atom.xml" class="social fas fa-rss flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a> <a href="mailto:a1364259@163.com" class="social fas fa-envelope flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a> <a href="https://github.com/canyie" class="social fab fa-github flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a></div><div><p>博客内容遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p></div>本站使用 <a href="https://volantis.js.org/" target="_blank" class="codename">Volantis</a> 作为主题，总访问量为 <span id="busuanzi_value_site_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span> 次<div class="copyright"><p>如对本站有任何疑问或建议，欢迎到 <a href="https://github.com/canyie/canyie.github.io/issues/" target="_blank" rel="noopener">issues 区</a> 反馈~</p></div></footer><script>setLoadingBarProgress(80)</script><script>setLoadingBarProgress(60)</script></div><a class="s-top fas fa-arrow-up fa-fw" href="javascript:void(0)"></a></div><script src="https://cdn.jsdelivr.net/npm/jquery@3.4/dist/jquery.min.js"></script><script>var SEARCH_SERVICE="hexo",ROOT="/";ROOT.endsWith("/")||(ROOT+="/")</script><script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/instant_page.js" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script><script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script><script type="text/javascript">$(function(){Waves.attach(".flat-btn",["waves-button"]),Waves.attach(".float-btn",["waves-button","waves-float"]),Waves.attach(".float-btn-light",["waves-button","waves-float","waves-light"]),Waves.attach(".flat-box",["waves-block"]),Waves.attach(".float-box",["waves-block","waves-float"]),Waves.attach(".waves-image"),Waves.init()})</script><script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script><script type="text/javascript">$(function(){var a=["https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/BBC19066-E176-47C2-9D22-48C81EE5DF6B.jpeg"];!function(a){for(var t=a.length;t--;){var r=Math.floor(Math.random()*t),n=a[r];a[r]=a[t],a[t]=n}}(a),$.backstretch(a,{duration:"20000",fade:"1500"})})</script><script src="/js/app.js"></script><script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.4/js/search.js"></script><script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/comment_typing.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script><script>function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-check-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('fa-check-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-times-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('fa-times-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);</script><script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script>let LAZY_LOAD_IMAGE = "[object Object]";
  $(".article-entry").find("div.fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });</script><script>setLoadingBarProgress(100)</script><script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var i=n.imageLazyLoadSetting.isSPA,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){i&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,e,a=0;a<r.length;a++)t=r[a],e=void 0,0<=(e=t.getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(n.innerHeight||document.documentElement.clientHeight)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},n.src=i}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script></body></html>